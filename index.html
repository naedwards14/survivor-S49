<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survivor 49 Fantasy League - FINALE</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .app-container {
            max-width: 1800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #e17055 0%, #fdcb6e 50%, #00b894 100%);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 3.5em;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            margin-bottom: 10px;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .header .subtitle {
            font-size: 1.5em;
            opacity: 0.9;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .navigation {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 12px 30px;
            font-size: 1.1em;
            font-weight: bold;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            color: white;
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .nav-button.active {
            transform: scale(1.05);
            box-shadow: 0 6px 25px rgba(0,0,0,0.4);
        }

        .nav-button:nth-child(1) { background: linear-gradient(135deg, #f39c12, #e67e22); }
        .nav-button:nth-child(2) { background: linear-gradient(135deg, #3498db, #2980b9); }
        .nav-button:nth-child(3) { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .nav-button:nth-child(4) { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .nav-button:nth-child(5) { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .nav-button:nth-child(6) { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
        .nav-button:nth-child(7) { background: linear-gradient(135deg, #16a085, #1abc9c); }
        .nav-button:nth-child(8) { background: linear-gradient(135deg, #f39c12, #d35400); }

        .content-section {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .section-title {
            font-size: 2em;
            margin-bottom: 25px;
            text-align: center;
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
        }

        /* Leaderboard Styles */
        .leaderboard {
            display: grid;
            gap: 15px;
        }

        .leaderboard-item {
            display: grid;
            grid-template-columns: 60px 1fr 120px 100px;
            align-items: center;
            padding: 20px;
            background: rgba(255,255,255,0.08);
            border-radius: 10px;
            transition: all 0.3s ease;
            border-left: 5px solid transparent;
        }

        .leaderboard-item:hover {
            background: rgba(255,255,255,0.12);
            transform: translateX(5px);
        }

        .leaderboard-item.rank-1 {
            border-left-color: #f1c40f;
            background: linear-gradient(90deg, rgba(241,196,15,0.2) 0%, rgba(255,255,255,0.08) 100%);
        }

        .leaderboard-item.rank-2 {
            border-left-color: #95a5a6;
            background: linear-gradient(90deg, rgba(149,165,166,0.2) 0%, rgba(255,255,255,0.08) 100%);
        }

        .leaderboard-item.rank-3 {
            border-left-color: #cd7f32;
            background: linear-gradient(90deg, rgba(205,127,50,0.2) 0%, rgba(255,255,255,0.08) 100%);
        }

        .rank {
            font-size: 2em;
            font-weight: bold;
            text-align: center;
        }

        .player-name {
            font-size: 1.4em;
            font-weight: bold;
        }

        .player-stats {
            display: flex;
            gap: 15px;
            font-size: 0.9em;
            color: #bbb;
        }

        .total-points {
            font-size: 1.8em;
            font-weight: bold;
            text-align: right;
            color: #4ecca3;
        }

        /* Draft Board Styles */
        .draft-board {
            overflow-x: auto;
        }

        .draft-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 900px;
        }

        .draft-table th {
            background: rgba(255,255,255,0.1);
            padding: 15px 10px;
            font-size: 1.1em;
            border: 1px solid rgba(255,255,255,0.1);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .draft-table td {
            padding: 12px 10px;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: center;
            font-size: 1em;
            font-weight: 500;
        }

        .draft-table tr:hover {
            background: rgba(255,255,255,0.05);
        }

        .contestant-cell {
            transition: all 0.2s ease;
        }

        .contestant-cell:hover {
            transform: scale(1.05);
        }

        .tribe-hina {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
            font-weight: bold;
        }

        .tribe-kele {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            font-weight: bold;
        }

        .tribe-uli {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            font-weight: bold;
        }

        .eliminated {
            background: #666 !important;
            opacity: 0.6;
        }

        /* Contestant Grid */
        .contestant-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .contestant-card {
            background: rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            cursor: pointer;
        }

        .contestant-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .contestant-card.tribe-hina { border-color: #f39c12; }
        .contestant-card.tribe-kele { border-color: #3498db; }
        .contestant-card.tribe-uli { border-color: #e74c3c; }
        .contestant-card.eliminated {
            opacity: 0.4;
            filter: grayscale(100%);
        }

        .contestant-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .contestant-tribe {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9em;
            display: inline-block;
            margin-bottom: 8px;
        }

        .contestant-points {
            font-size: 1.5em;
            color: #4ecca3;
            font-weight: bold;
        }

        /* Weekly Scores */
        .week-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .week-button {
            padding: 10px 20px;
            font-size: 1em;
            font-weight: bold;
            border: 2px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.05);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .week-button:hover {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.5);
        }

        .week-button.active {
            background: linear-gradient(135deg, #4ecca3, #00b894);
            border-color: #4ecca3;
            transform: scale(1.05);
        }

        .scoring-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .scoring-table th,
        .scoring-table td {
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: center;
            font-size: 0.95em;
        }

        .scoring-table th {
            background: rgba(255,255,255,0.1);
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 5;
            cursor: pointer;
            user-select: none;
        }

        .scoring-table th:hover {
            background: rgba(255,255,255,0.15);
        }

        .scoring-table th.sortable::after {
            content: ' ‚áÖ';
            opacity: 0.5;
        }

        .scoring-table th.sorted-asc::after {
            content: ' ‚Üë';
            opacity: 1;
        }

        .scoring-table th.sorted-desc::after {
            content: ' ‚Üì';
            opacity: 1;
        }

        .scoring-table tr:hover {
            background: rgba(255,255,255,0.05);
        }

        .category-cell {
            text-align: left;
            padding-left: 15px;
            font-weight: 500;
        }

        .points-value {
            font-weight: bold;
        }

        .positive-points {
            color: #4ecca3;
        }

        .negative-points {
            color: #e74c3c;
        }

        /* Attendance */
        .attendance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .attendance-card {
            background: rgba(255,255,255,0.08);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .attendance-card:hover {
            background: rgba(255,255,255,0.12);
            transform: translateY(-3px);
        }

        .attendance-name {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .attendance-count {
            font-size: 2em;
            color: #4ecca3;
            font-weight: bold;
        }

        .attendance-weeks {
            margin-top: 10px;
            font-size: 0.85em;
            color: #bbb;
        }

        .tribe-legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1em;
            font-weight: bold;
        }

        .legend-color {
            width: 30px;
            height: 30px;
            border-radius: 5px;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #4ecca3;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 1.1em;
            color: #bbb;
        }

        /* Checkbox Scoring Styles */
        .scoring-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .scoring-checkbox-item {
            background: rgba(255,255,255,0.05);
            padding: 12px 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .scoring-checkbox-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .scoring-checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .scoring-checkbox-label {
            flex: 1;
            font-size: 0.95em;
            cursor: pointer;
        }

        .scoring-checkbox-points {
            font-weight: bold;
            font-size: 1.1em;
            min-width: 50px;
            text-align: right;
        }

        .scoring-checkbox-points.positive {
            color: #4ecca3;
        }

        .scoring-checkbox-points.negative {
            color: #e74c3c;
        }

        .contestant-scoring-section {
            background: rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .contestant-scoring-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }

        .contestant-scoring-name {
            font-size: 1.5em;
            font-weight: bold;
        }

        .contestant-scoring-total {
            font-size: 1.8em;
            font-weight: bold;
            color: #4ecca3;
        }

        /* Grid Scoring Styles */
        .grid-scoring-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 0.9em;
        }

        .grid-scoring-table th,
        .grid-scoring-table td {
            border: 1px solid rgba(255,255,255,0.2);
            padding: 10px 8px;
            text-align: center;
        }

        .grid-scoring-table th {
            background: rgba(255,255,255,0.1);
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 5;
        }

        .grid-scoring-table .category-header {
            text-align: left;
            padding-left: 15px;
            min-width: 300px;
            background: rgba(255,255,255,0.08);
        }

        .grid-scoring-table .contestant-header {
            min-width: 80px;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            padding: 15px 8px;
            font-size: 1.1em;
        }

        .grid-scoring-table .eliminated-header {
            opacity: 0.5;
        }

        .grid-scoring-table input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .grid-scoring-table .total-row {
            background: rgba(78,204,163,0.15);
            font-weight: bold;
            font-size: 1.1em;
        }

        .grid-scoring-table .total-points-cell {
            color: #4ecca3;
            font-size: 1.2em;
        }

        .grid-scoring-table .category-points {
            color: #4ecca3;
            font-size: 0.85em;
            font-weight: bold;
            margin-left: 8px;
        }

        .grid-scoring-table .category-points.negative {
            color: #e74c3c;
        }

        .grid-scoring-table tr:hover {
            background: rgba(255,255,255,0.05);
        }

        /* Elimination Timeline Styles */
        .elimination-timeline {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }

        .elimination-item {
            background: rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 20px;
            border-left: 5px solid #e74c3c;
            transition: all 0.3s ease;
        }

        .elimination-item:hover {
            background: rgba(255,255,255,0.12);
            transform: translateX(5px);
        }

        .elimination-item.medical {
            border-left-color: #f39c12;
            background: linear-gradient(90deg, rgba(243,156,18,0.15) 0%, rgba(255,255,255,0.08) 100%);
        }

        .elimination-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .elimination-week {
            font-size: 1.5em;
            font-weight: bold;
            color: #4ecca3;
        }

        .elimination-name {
            font-size: 1.8em;
            font-weight: bold;
            color: #fff;
        }

        .elimination-badge {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .elimination-badge.voted {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .elimination-badge.medical {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .elimination-reason {
            font-size: 1.1em;
            line-height: 1.6;
            color: #ddd;
            margin-top: 10px;
        }

        /* Score Entry Styles */
        .score-entry-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .score-entry-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .score-entry-table th,
        .score-entry-table td {
            padding: 12px 8px;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: center;
        }

        .score-entry-table th {
            background: rgba(255,255,255,0.1);
            font-weight: bold;
            font-size: 0.95em;
        }

        .score-entry-table input {
            width: 60px;
            padding: 6px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 5px;
            color: white;
            text-align: center;
            font-size: 0.95em;
        }

        .score-entry-table input:focus {
            outline: none;
            border-color: #4ecca3;
            background: rgba(78,204,163,0.15);
        }

        .score-entry-table .category-name {
            text-align: left;
            padding-left: 15px;
            font-weight: 500;
        }

        .save-button {
            margin-top: 20px;
            padding: 15px 40px;
            font-size: 1.2em;
            font-weight: bold;
            background: linear-gradient(135deg, #4ecca3, #00b894);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(78,204,163,0.3);
            transition: all 0.3s ease;
        }

        .save-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(78,204,163,0.4);
        }

        .save-button:active {
            transform: translateY(0);
        }

        .info-banner {
            background: rgba(78,204,163,0.15);
            border: 1px solid rgba(78,204,163,0.3);
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .info-banner.warning {
            background: rgba(243,156,18,0.15);
            border-color: rgba(243,156,18,0.3);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .header .subtitle {
                font-size: 1em;
            }

            .leaderboard-item {
                grid-template-columns: 50px 1fr 80px;
                font-size: 0.9em;
            }

            .player-stats {
                display: none;
            }

            .nav-button {
                padding: 10px 20px;
                font-size: 0.95em;
            }

            .score-entry-table input {
                width: 50px;
                padding: 4px;
                font-size: 0.85em;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Scoring categories and their point values
        const scoringCategories = [
            { id: 'team_reward', name: 'Won team reward (worth nothing if combined)', points: 1 },
            { id: 'team_immunity', name: 'Won team immunity', points: 1 },
            { id: 'second_team_immunity', name: 'Second in team immunity', points: 0.5 },
            { id: 'individual_reward', name: 'Won individual reward (worth nothing if combined)', points: 2 },
            { id: 'individual_immunity', name: 'Won individual immunity', points: 2 },
            { id: 'taken_reward', name: 'Taken on individual reward', points: 1 },
            { id: 'mini_reward', name: 'Mini reward victory', points: 0.5 },
            { id: 'title_quote', name: 'Episode title quote', points: 0.25 },
            { id: 'idol_tribal', name: 'Has idol at end of episode and was at tribal', points: 1 },
            { id: 'idol_used', name: 'Uses idol (or successful dice)', points: 0.5 },
            { id: 'voted_idol', name: 'Voted off with idol', points: -3 },
            { id: 'premerge_survive', name: 'Pre-merge surviving an elimination', points: 0.75 },
            { id: 'postmerge_survive', name: 'Post-merge surviving an elimination', points: 1 },
            { id: 'shot_in_dark', name: 'Goes home with shot in the dark', points: -0.5 },
            { id: 'quits', name: 'Quits', points: -3 },
            { id: 'final_group', name: 'Made final group', points: 2 },
            { id: 'vote_final', name: 'Vote in final group', points: 0.5 },
            { id: 'won_survivor', name: 'Won survivor', points: 7.5 }
        ];

        const SurvivorLeague = () => {
            const [activeView, setActiveView] = useState('leaderboard');
            const [selectedWeek, setSelectedWeek] = useState(13);
            const [sortConfig, setSortConfig] = useState({ key: null, direction: 'desc' });

            // Load data from localStorage or use initial data
            const getInitialData = () => {
                const savedData = localStorage.getItem('survivorLeagueData');
                if (savedData) {
                    return JSON.parse(savedData);
                }
                return {
                    contestants: [
                        { name: "Alex", tribe: "Kele", originalTribe: "Kele", eliminated: false, eliminatedWeek: null },
                        { name: "Jawan", tribe: "Uli", originalTribe: "Uli", eliminated: false, eliminatedWeek: null },
                        { name: "Kristina", tribe: "Voted Out", originalTribe: "Hina", eliminated: true, eliminatedWeek: 13 },
                        { name: "Rizo", tribe: "Uli", originalTribe: "Uli", eliminated: false, eliminatedWeek: null },
                        { name: "Sage", tribe: "Uli", originalTribe: "Uli", eliminated: false, eliminatedWeek: null },
                        { name: "Savannah", tribe: "Uli", originalTribe: "Uli", eliminated: false, eliminatedWeek: null },
                        { name: "Sophi", tribe: "Kele", originalTribe: "Kele", eliminated: false, eliminatedWeek: null },
                        { name: "Sophie", tribe: "Hina", originalTribe: "Hina", eliminated: false, eliminatedWeek: null },
                        { name: "Steven", tribe: "Hina", originalTribe: "Hina", eliminated: false, eliminatedWeek: null },
                        { name: "Annie", tribe: "Voted Out", originalTribe: "Kele", eliminated: true, eliminatedWeek: 2 },
                        { name: "Jake", tribe: "Kele", originalTribe: "Kele", eliminated: true, eliminatedWeek: 3 },
                        { name: "Jason", tribe: "Hina", originalTribe: "Hina", eliminated: true, eliminatedWeek: 5 },
                        { name: "Jeremiah", tribe: "Kele", originalTribe: "Kele", eliminated: true, eliminatedWeek: 3 },
                        { name: "Matt", tribe: "Hina", originalTribe: "Hina", eliminated: true, eliminatedWeek: 4 },
                        { name: "MC", tribe: "Voted Out", originalTribe: "Kele", eliminated: true, eliminatedWeek: 8 },
                        { name: "Nate", tribe: "Voted Out", originalTribe: "Uli", eliminated: true, eliminatedWeek: 7 },
                        { name: "Nicole", tribe: "Voted Out", originalTribe: "Kele", eliminated: true, eliminatedWeek: 1 },
                        { name: "Shannon", tribe: "Uli", originalTribe: "Uli", eliminated: true, eliminatedWeek: 6 }
                    ],
                    weeklyScores: {
                        1: { "Alex": 0, "Annie": 0, "Nicole": -0.5, "Sophi": 0, "Jeremiah": 0, "Jake": 0, "Jawan": 0.75, "Nate": 0.5, "Rizo": 1, "Sage": 0.5, "Savannah": 0.5, "Shannon": 0.5, "Kristina": 2, "Matt": 2, "MC": 2, "Jason": 2, "Sophie": 2, "Steven": 2 },
                        2: { "Alex": 1.75, "Annie": -0.5, "Nicole": 0, "Sophi": 0.75, "Jeremiah": 0.75, "Jake": 0.75, "Jawan": 1, "Nate": 0.5, "Rizo": 0.75, "Sage": 0.5, "Savannah": 0.5, "Shannon": 0.5, "Kristina": 1, "Matt": 1, "MC": 1, "Jason": 1, "Sophie": 1, "Steven": 1 },
                        3: { "Alex": 1.25, "Annie": 0, "Nicole": 0, "Sophi": 0.75, "Jeremiah": -0.5, "Jake": 0, "Jawan": 0.5, "Nate": 0.5, "Rizo": 0.5, "Sage": 0.5, "Savannah": 0.5, "Shannon": 0.5, "Kristina": 1, "Matt": 1, "MC": 1, "Jason": 1, "Sophie": 1, "Steven": 1 },
                        4: { "Alex": 1, "Annie": 0, "Nicole": 0, "Sophi": 0.75, "Jeremiah": 0, "Jake": 0, "Jawan": 0.75, "Nate": 1, "Rizo": 1.75, "Sage": 1, "Savannah": 0.75, "Shannon": 1, "Kristina": 1, "Matt": -0.5, "MC": 1, "Jason": 0.75, "Sophie": 1, "Steven": 1 },
                        5: { "Alex": 1, "Annie": 0, "Nicole": 0, "Sophi": 0.75, "Jeremiah": 0, "Jake": 0, "Jawan": 0.75, "Nate": 1.25, "Rizo": 1.75, "Sage": 1.25, "Savannah": 0.75, "Shannon": 1, "Kristina": 1, "Matt": 0, "MC": 1.5, "Jason": -0.5, "Sophie": 1, "Steven": 1 },
                        6: { "Alex": 1, "Annie": 0, "Nicole": 0, "Sophi": 2, "Jeremiah": 0, "Jake": 0, "Jawan": 0.75, "Nate": 1, "Rizo": 2.25, "Sage": 0.75, "Savannah": 2, "Shannon": -0.5, "Kristina": 1, "Matt": 0, "MC": 2, "Jason": 0, "Sophie": 1, "Steven": 0.75 },
                        7: { "Alex": 1, "Annie": 0, "Nicole": 0, "Sophi": 2, "Jeremiah": 0, "Jake": 0, "Jawan": 1, "Nate": 0.5, "Rizo": 3.25, "Sage": 1.5, "Savannah": 1, "Shannon": 0, "Kristina": 1, "Matt": 0, "MC": 1, "Jason": 0, "Sophie": 4, "Steven": 2 },
                        8: { "Alex": 1, "Annie": 0, "Nicole": 0, "Sophi": 1, "Jeremiah": 0, "Jake": 0, "Jawan": 1, "Nate": 0, "Rizo": 2, "Sage": 1, "Savannah": 2.75, "Shannon": 0, "Kristina": 1, "Matt": 0, "MC": -0.5, "Jason": 0, "Sophie": 1, "Steven": 1 },
                        9: {},
                        10: {},
                        11: {},
                        12: {},
                        13: { "Alex": 0, "Annie": 0, "Nicole": 0, "Sophi": 6.75, "Jeremiah": 0, "Jake": 0, "Jawan": 0, "Nate": 0, "Rizo": 1, "Sage": 4.5, "Savannah": 15, "Shannon": 0, "Kristina": -0.5, "Matt": 0, "MC": 0, "Jason": 0, "Sophie": 0, "Steven": 0 }
                    },
                    draftData: [
                        { player: "Dan", picks: ["Savannah", "Rizo", "Kristina", "Nate", "Sage", "Annie"], left: 3 },
                        { player: "Julie", picks: ["Savannah", "Alex", "Sophi", "Nate", "Kristina", "Annie"], left: 3 },
                        { player: "Lindsay", picks: ["Alex", "Steven", "Sophi", "Shannon", "Jawan", "Annie"], left: 4 },
                        { player: "Brett/Emma", picks: ["Savannah", "Nate", "Sophi", "Shannon", "Matt", "Annie"], left: 2 },
                        { player: "Jack", picks: ["Jake", "Alex", "Shannon", "Nate", "Matt", "Annie"], left: 1 },
                        { player: "Gab", picks: ["Savannah", "Alex", "Rizo", "Annie", "Jawan", "Sage"], left: 4 },
                        { player: "Neil", picks: ["Savannah", "Jake", "Rizo", "Nate", "Matt", "Sage"], left: 3 },
                        { player: "Jenny", picks: ["Savannah", "Alex", "Sophi", "Jason", "Nate", "Sophie"], left: 4 },
                        { player: "David", picks: ["Jake", "MC", "Steven", "Jason", "Jeremiah", "Sophie"], left: 2 },
                        { player: "Sue", picks: ["Jake", "MC", "Sophi", "Sage", "Jawan", "Sophie"], left: 4 },
                        { player: "Ryan", picks: ["Jake", "MC", "Rizo", "Steven", "Jawan", "Sophie"], left: 4 },
                        { player: "Jason", picks: ["Jason", "MC", "Steven", "Shannon", "Jawan", "Sophie"], left: 3 },
                        { player: "Alex", picks: ["Rizo", "Alex", "Sophi", "Matt", "Kristina", "Sage"], left: 4 },
                        { player: "Debbie", picks: ["Jake", "MC", "Shannon", "Jawan", "Kristina", "Jeremiah"], left: 1 },
                        { player: "Kristen", picks: ["Jason", "Steven", "Matt", "Jeremiah", "Jeremiah", "Sophie"], left: 2 },
                        { player: "Jenn", picks: ["Jason", "Shannon", "Steven", "Jeremiah", "Kristina", "Sage"], left: 2 },
                        { player: "Mel", picks: ["Rizo", "MC", "Jason", "Matt", "Jeremiah", "Kristina"], left: 1 }
                    ],
                    attendanceData: {
                        "Dan": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
                        "Julie": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
                        "Lindsay": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
                        "Brett/Emma": [0, 2, 2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0],
                        "Jack": [0, 2, 0, 2, 2, 0, 0, 0, 2, 0, 0, 0, 0],
                        "Gab": [0, 2, 0, 2, 2, 0, 2, 2, 2, 2, 0, 2, 2],
                        "Neil": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
                        "Jenny": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
                        "David": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
                        "Sue": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
                        "Ryan": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
                        "Jason": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
                        "Alex": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
                        "Debbie": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 2],
                        "Kristen": [0, 2, 0, 0, 0, 2, 0, 2, 0, 0, 0, 0, 0],
                        "Jenn": [0, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 0, 0],
                        "Mel": [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0]
                    },
                    savannahPredictions: {
                        "Dan": 10, "Julie": 6, "Lindsay": 2, "Brett/Emma": 1, "Jack": 2,
                        "Gab": 3, "Neil": 10, "Jenny": 5, "David": 8, "Sue": 2,
                        "Ryan": 0, "Jason": 3, "Alex": 6, "Debbie": 1, "Kristen": 1,
                        "Jenn": 2, "Mel": 0
                    },
                    eliminationTimeline: [
                        { week: 1, contestant: "Nicole", reason: "Voted out at the first Tribal Council for being perceived as a weaker player in challenges." },
                        { week: 2, contestant: "Annie", reason: "Voted out after her strategic maneuvering put a target on her back." },
                        { week: 3, contestant: "Jeremiah", reason: "Voted out." },
                        { week: 3, contestant: "Jake", reason: "Medically evacuated due to a venomous snake bite (did not attend Tribal Council).", medical: true },
                        { week: 4, contestant: "Matt", reason: "Voted out after a tribe swap left him on the bottom of his new tribe." },
                        { week: 5, contestant: "Jason", reason: "Voted out after being unable to secure a solid alliance post-tribe swap." },
                        { week: 6, contestant: "Shannon", reason: "Voted out." },
                        { week: 7, contestant: "Nate", reason: "The first member of the jury; blindsided at the first post-merge Tribal Council." },
                        { week: 8, contestant: "MC", reason: "The second member of the jury; voted out after an intense live Tribal Council where her attempt to share new information backfired." },
                        { week: 13, contestant: "Kristina", reason: "Fourth member of the jury; eliminated in the final 5 before the final tribal council, where Savannah was crowned Sole Survivor." }
                    ]
                };
            };

            const [data, setData] = useState(() => {
                const initialData = getInitialData();
                // Data migration: ensure all contestants have originalTribe field
                const originalTribes = {
                    "Nicole": "Kele", "Annie": "Kele", "Jeremiah": "Kele", "Jake": "Kele",
                    "Matt": "Hina", "Jason": "Hina", "MC": "Kele", "Nate": "Uli", "Shannon": "Uli"
                };
                
                initialData.contestants = initialData.contestants.map(contestant => {
                    if (!contestant.originalTribe) {
                        return {
                            ...contestant,
                            originalTribe: originalTribes[contestant.name] || contestant.tribe
                        };
                    }
                    return contestant;
                });
                
                return initialData;
            });

            // Save data to localStorage whenever it changes
            useEffect(() => {
                localStorage.setItem('survivorLeagueData', JSON.stringify(data));
            }, [data]);

            // Calculate total points for each contestant
            const contestantTotals = useMemo(() => {
                const totals = {};
                data.contestants.forEach(contestant => {
                    let total = 0;
                    for (let week = 1; week <= 13; week++) {
                        total += data.weeklyScores[week][contestant.name] || 0;
                    }
                    totals[contestant.name] = total;
                });
                return totals;
            }, [data.weeklyScores, data.contestants]);

            // Sort contestants by tribe then alphabetically
            const sortedContestants = useMemo(() => {
                return [...data.contestants].sort((a, b) => {
                    // First sort by tribe (current tribe, so eliminated contestants show at end as "Voted Out")
                    const tribeOrder = { "Hina": 1, "Kele": 2, "Uli": 3, "Voted Out": 4 };
                    const tribeDiff = tribeOrder[a.tribe] - tribeOrder[b.tribe];
                    if (tribeDiff !== 0) return tribeDiff;
                    // Then alphabetically
                    return a.name.localeCompare(b.name);
                });
            }, [data.contestants]);

            // Calculate leaderboard
            const leaderboard = useMemo(() => {
                const scores = data.draftData.map(entry => {
                    let totalPoints = 0;
                    let attendancePoints = 0;
                    let savannahBonus = 0;
                    
                    // Calculate contestant points
                    entry.picks.forEach(pick => {
                        totalPoints += contestantTotals[pick] || 0;
                    });
                    
                    // Calculate attendance points
                    if (data.attendanceData[entry.player]) {
                        attendancePoints = data.attendanceData[entry.player].reduce((sum, val) => sum + val, 0);
                    }
                    
                    // Get Savannah prediction bonus
                    if (data.savannahPredictions && data.savannahPredictions[entry.player]) {
                        savannahBonus = data.savannahPredictions[entry.player];
                    }
                    
                    return {
                        player: entry.player,
                        totalPoints: totalPoints + attendancePoints + savannahBonus,
                        contestantPoints: totalPoints,
                        attendancePoints: attendancePoints,
                        savannahBonus: savannahBonus,
                        contestantsLeft: entry.left
                    };
                });
                
                return scores.sort((a, b) => b.totalPoints - a.totalPoints);
            }, [contestantTotals, data.draftData, data.attendanceData, data.savannahPredictions]);

            // Sorting function for weekly scores
            const handleSort = (key) => {
                let direction = 'desc';
                if (sortConfig.key === key && sortConfig.direction === 'desc') {
                    direction = 'asc';
                }
                setSortConfig({ key, direction });
            };

            const getSortedWeeklyData = () => {
                // First filter to only active contestants for this week
                let sorted = sortedContestants.filter(contestant => {
                    return !contestant.eliminated || contestant.eliminatedWeek >= selectedWeek;
                });
                
                if (sortConfig.key === 'name') {
                    sorted.sort((a, b) => {
                        const compare = a.name.localeCompare(b.name);
                        return sortConfig.direction === 'asc' ? compare : -compare;
                    });
                } else if (sortConfig.key === 'tribe') {
                    sorted.sort((a, b) => {
                        const compare = a.tribe.localeCompare(b.tribe);
                        return sortConfig.direction === 'asc' ? compare : -compare;
                    });
                } else if (sortConfig.key === 'weekPoints') {
                    sorted.sort((a, b) => {
                        const aPoints = data.weeklyScores[selectedWeek][a.name] || 0;
                        const bPoints = data.weeklyScores[selectedWeek][b.name] || 0;
                        return sortConfig.direction === 'asc' ? aPoints - bPoints : bPoints - aPoints;
                    });
                } else if (sortConfig.key === 'totalPoints') {
                    sorted.sort((a, b) => {
                        let aTotalThroughWeek = 0;
                        let bTotalThroughWeek = 0;
                        for (let w = 1; w <= selectedWeek; w++) {
                            aTotalThroughWeek += data.weeklyScores[w][a.name] || 0;
                            bTotalThroughWeek += data.weeklyScores[w][b.name] || 0;
                        }
                        return sortConfig.direction === 'asc' ? aTotalThroughWeek - bTotalThroughWeek : bTotalThroughWeek - aTotalThroughWeek;
                    });
                } else if (sortConfig.key === 'status') {
                    sorted.sort((a, b) => {
                        const aElim = a.eliminated && a.eliminatedWeek <= selectedWeek ? 1 : 0;
                        const bElim = b.eliminated && b.eliminatedWeek <= selectedWeek ? 1 : 0;
                        return sortConfig.direction === 'asc' ? aElim - bElim : bElim - aElim;
                    });
                }
                
                return sorted;
            };

            const renderLeaderboard = () => (
                <div className="content-section">
                    <h2 className="section-title">üèÜ Current Standings üèÜ</h2>
                    <div className="leaderboard">
                        {leaderboard.map((entry, index) => (
                            <div 
                                key={entry.player} 
                                className={`leaderboard-item rank-${index + 1}`}
                            >
                                <div className="rank">#{index + 1}</div>
                                <div>
                                    <div className="player-name">{entry.player}</div>
                                    <div className="player-stats">
                                        <span>Contestants: {entry.contestantPoints.toFixed(2)} pts</span>
                                        <span>Attendance: {entry.attendancePoints} pts</span>
                                        <span>Savannah Bonus: {entry.savannahBonus} pts</span>
                                        <span>{entry.contestantsLeft} left</span>
                                    </div>
                                </div>
                                <div className="total-points">{entry.totalPoints.toFixed(2)}</div>
                            </div>
                        ))}
                    </div>
                    
                    <div className="summary-stats">
                        <div className="stat-card">
                            <div className="stat-label">Episodes Completed</div>
                            <div className="stat-value">13/13</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">Contestants Remaining</div>
                            <div className="stat-value">üèÜ COMPLETE!</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">Contestants Eliminated</div>
                            <div className="stat-value">10</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">League Players</div>
                            <div className="stat-value">{leaderboard.length}</div>
                        </div>
                    </div>
                </div>
            );

            const renderDraftBoard = () => {
                // Sort draft data by contestants left (descending)
                const sortedDraftData = [...data.draftData].sort((a, b) => b.left - a.left);
                
                return (
                <div className="content-section">
                    <h2 className="section-title">üìã Draft Board üìã</h2>
                    <div className="tribe-legend">
                        <div className="legend-item">
                            <div className="legend-color" style={{background: 'linear-gradient(135deg, #f39c12, #e67e22)'}}></div>
                            <span>Hina</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: 'linear-gradient(135deg, #3498db, #2980b9)'}}></div>
                            <span>Kele</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: 'linear-gradient(135deg, #e74c3c, #c0392b)'}}></div>
                            <span>Uli</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: '#666'}}></div>
                            <span>Eliminated</span>
                        </div>
                    </div>
                    <div className="draft-board">
                        <table className="draft-table">
                            <thead>
                                <tr>
                                    <th># Left</th>
                                    <th>Player</th>
                                    <th>Pick 1</th>
                                    <th>Pick 2</th>
                                    <th>Pick 3</th>
                                    <th>Pick 4</th>
                                    <th>Pick 5</th>
                                    <th>Pick 6</th>
                                </tr>
                            </thead>
                            <tbody>
                                {sortedDraftData.map((entry, idx) => (
                                    <tr key={idx}>
                                        <td style={{fontWeight: 'bold', fontSize: '1.2em'}}>{entry.left}</td>
                                        <td style={{fontWeight: 'bold', textAlign: 'left', paddingLeft: '15px'}}>{entry.player}</td>
                                        {entry.picks.map((pick, pickIdx) => {
                                            const contestant = data.contestants.find(c => c.name === pick);
                                            const tribeClass = contestant.tribe === "Hina" ? "tribe-hina" : 
                                                             contestant.tribe === "Kele" ? "tribe-kele" : 
                                                             contestant.tribe === "Uli" ? "tribe-uli" : "";
                                            const eliminatedClass = contestant.eliminated ? "eliminated" : "";
                                            return (
                                                <td key={pickIdx} className={`contestant-cell ${tribeClass} ${eliminatedClass}`}>
                                                    {pick}
                                                </td>
                                            );
                                        })}
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );};

            const renderContestants = () => {
                // Sort to show active contestants first, then eliminated by points
                const sortedForDisplay = [...sortedContestants].sort((a, b) => {
                    // Active contestants (not eliminated) come first
                    if (!a.eliminated && b.eliminated) return -1;
                    if (a.eliminated && !b.eliminated) return 1;
                    
                    // If both eliminated, sort by total points (descending)
                    if (a.eliminated && b.eliminated) {
                        const aPoints = contestantTotals[a.name] || 0;
                        const bPoints = contestantTotals[b.name] || 0;
                        return bPoints - aPoints;
                    }
                    
                    // If both active, sort by tribe then alphabetically
                    const tribeOrder = { "Hina": 1, "Kele": 2, "Uli": 3, "Voted Out": 4 };
                    const aTribe = a.originalTribe || a.tribe;
                    const bTribe = b.originalTribe || b.tribe;
                    const tribeDiff = tribeOrder[aTribe] - tribeOrder[bTribe];
                    if (tribeDiff !== 0) return tribeDiff;
                    return a.name.localeCompare(b.name);
                });
                
                const activeCount = sortedForDisplay.filter(c => !c.eliminated).length;
                
                return (
                <div className="content-section">
                    <h2 className="section-title">üå¥ All Contestants üå¥</h2>
                    <div className="tribe-legend">
                        <div className="legend-item">
                            <div className="legend-color" style={{background: 'linear-gradient(135deg, #f39c12, #e67e22)'}}></div>
                            <span>Hina (3 remaining of 6)</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: 'linear-gradient(135deg, #3498db, #2980b9)'}}></div>
                            <span>Kele (2 remaining of 6)</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: 'linear-gradient(135deg, #e74c3c, #c0392b)'}}></div>
                            <span>Uli (3 remaining of 6)</span>
                        </div>
                    </div>
                    <div style={{textAlign: 'center', marginBottom: '20px', fontSize: '1.2em', color: '#4ecca3'}}>
                        <strong>SEASON COMPLETE! Showing {activeCount} finalists first, then {sortedForDisplay.length - activeCount} eliminated (sorted by points)</strong>
                    </div>
                    <div className="contestant-grid">
                        {sortedForDisplay.map((contestant, idx) => {
                            const tribeClass = contestant.tribe === "Hina" ? "tribe-hina" : 
                                             contestant.tribe === "Kele" ? "tribe-kele" : 
                                             contestant.tribe === "Uli" ? "tribe-uli" : "";
                            const eliminatedClass = contestant.eliminated ? "eliminated" : "";
                            const totalPoints = contestantTotals[contestant.name] || 0;
                            
                            return (
                                <div key={idx} className={`contestant-card ${tribeClass} ${eliminatedClass}`}>
                                    <div className="contestant-name">{contestant.name}</div>
                                    <div 
                                        className="contestant-tribe"
                                        style={{
                                            background: contestant.tribe === "Hina" ? "linear-gradient(135deg, #f39c12, #e67e22)" :
                                                       contestant.tribe === "Kele" ? "linear-gradient(135deg, #3498db, #2980b9)" :
                                                       contestant.tribe === "Uli" ? "linear-gradient(135deg, #e74c3c, #c0392b)" : "#666"
                                        }}
                                    >
                                        {contestant.tribe}
                                    </div>
                                    <div className="contestant-points">{totalPoints.toFixed(2)} pts</div>
                                    {contestant.eliminated && <div style={{color: '#e74c3c', fontSize: '0.9em', marginTop: '5px'}}>Eliminated Week {contestant.eliminatedWeek}</div>}
                                </div>
                            );
                        })}
                    </div>
                </div>
            );};

            const renderWeeklyScores = () => {
                const sortedData = getSortedWeeklyData();
                
                return (
                    <div className="content-section">
                        <h2 className="section-title">üìä Weekly Scores üìä</h2>
                        <div className="week-selector">
                            {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13].map(week => (
                                <button
                                    key={week}
                                    className={`week-button ${selectedWeek === week ? 'active' : ''}`}
                                    onClick={() => setSelectedWeek(week)}
                                >
                                    Week {week}
                                </button>
                            ))}
                        </div>
                        <div className="info-banner warning" style={{marginTop: '15px', marginBottom: '15px'}}>
                            üìä Week {selectedWeek} - Showing {sortedData.length} contestants (excluding those eliminated in previous weeks)
                        </div>
                        <div style={{overflowX: 'auto'}}>
                            <table className="scoring-table">
                                <thead>
                                    <tr>
                                        <th className={`sortable ${sortConfig.key === 'name' ? `sorted-${sortConfig.direction}` : ''}`} onClick={() => handleSort('name')}>
                                            Contestant
                                        </th>
                                        <th className={`sortable ${sortConfig.key === 'tribe' ? `sorted-${sortConfig.direction}` : ''}`} onClick={() => handleSort('tribe')}>
                                            Tribe
                                        </th>
                                        <th className={`sortable ${sortConfig.key === 'weekPoints' ? `sorted-${sortConfig.direction}` : ''}`} onClick={() => handleSort('weekPoints')}>
                                            Week {selectedWeek} Points
                                        </th>
                                        <th className={`sortable ${sortConfig.key === 'totalPoints' ? `sorted-${sortConfig.direction}` : ''}`} onClick={() => handleSort('totalPoints')}>
                                            Total (through Week {selectedWeek})
                                        </th>
                                        <th className={`sortable ${sortConfig.key === 'status' ? `sorted-${sortConfig.direction}` : ''}`} onClick={() => handleSort('status')}>
                                            Status
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {sortedData.map((contestant, idx) => {
                                        const weekPoints = data.weeklyScores[selectedWeek][contestant.name] || 0;
                                        let totalThroughWeek = 0;
                                        for (let w = 1; w <= selectedWeek; w++) {
                                            totalThroughWeek += data.weeklyScores[w][contestant.name] || 0;
                                        }
                                        
                                        const isEliminatedByThisWeek = contestant.eliminated && contestant.eliminatedWeek <= selectedWeek;
                                        
                                        const tribeClass = contestant.tribe === "Hina" ? "tribe-hina" : 
                                                         contestant.tribe === "Kele" ? "tribe-kele" : 
                                                         contestant.tribe === "Uli" ? "tribe-uli" : "";
                                        
                                        return (
                                            <tr key={idx} style={isEliminatedByThisWeek ? {opacity: 0.6} : {}}>
                                                <td style={{fontWeight: 'bold', textAlign: 'left', paddingLeft: '15px'}}>
                                                    {contestant.name}
                                                    {isEliminatedByThisWeek && contestant.eliminatedWeek === selectedWeek && 
                                                        <span style={{color: '#e74c3c', marginLeft: '8px', fontSize: '0.9em'}}>
                                                            (Eliminated this week)
                                                        </span>
                                                    }
                                                </td>
                                                <td>
                                                    <span className={`contestant-tribe ${tribeClass}`} style={{
                                                        padding: '5px 12px',
                                                        borderRadius: '12px',
                                                        display: 'inline-block',
                                                        fontSize: '0.9em'
                                                    }}>
                                                        {isEliminatedByThisWeek ? "Voted Out" : contestant.tribe}
                                                    </span>
                                                </td>
                                                <td className={`points-value ${weekPoints >= 0 ? 'positive-points' : 'negative-points'}`}>
                                                    {weekPoints >= 0 ? '+' : ''}{weekPoints.toFixed(2)}
                                                </td>
                                                <td className="positive-points" style={{fontWeight: 'bold'}}>
                                                    {totalThroughWeek.toFixed(2)}
                                                </td>
                                                <td>
                                                    {isEliminatedByThisWeek ? 
                                                        <span style={{color: '#e74c3c'}}>‚ùå Eliminated</span> : 
                                                        <span style={{color: '#4ecca3'}}>‚úì Active</span>
                                                    }
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>
                    </div>
                );
            };

            const renderEliminations = () => (
                <div className="content-section">
                    <h2 className="section-title">üî• Elimination Timeline üî•</h2>
                    <div className="elimination-timeline">
                        {data.eliminationTimeline.map((elim, idx) => (
                            <div key={idx} className={`elimination-item ${elim.medical ? 'medical' : ''}`}>
                                <div className="elimination-header">
                                    <div>
                                        <div className="elimination-week">Episode {elim.week}</div>
                                        <div className="elimination-name">{elim.contestant}</div>
                                    </div>
                                    <div className={`elimination-badge ${elim.medical ? 'medical' : 'voted'}`}>
                                        {elim.medical ? 'üè• Medical' : 'üî• Voted Out'}
                                    </div>
                                </div>
                                <div className="elimination-reason">
                                    {elim.reason}
                                </div>
                            </div>
                        ))}
                    </div>
                    <div className="summary-stats">
                        <div className="stat-card">
                            <div className="stat-label">Total Eliminations</div>
                            <div className="stat-value">10</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">Voted Out</div>
                            <div className="stat-value">9</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">Medical Evacuations</div>
                            <div className="stat-value">1</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-label">Jury Members</div>
                            <div className="stat-value">4</div>
                        </div>
                    </div>
                </div>
            );

            const renderAttendance = () => (
                <div className="content-section">
                    <h2 className="section-title">üìÖ Attendance Tracker üìÖ</h2>
                    <div className="attendance-grid">
                        {Object.entries(data.attendanceData)
                            .sort((a, b) => b[1].reduce((sum, val) => sum + val, 0) - a[1].reduce((sum, val) => sum + val, 0))
                            .map(([player, weeks]) => {
                                const totalAttendance = weeks.reduce((sum, val) => sum + val, 0);
                                const weeksAttended = weeks.filter(val => val > 0).length;
                                
                                return (
                                    <div key={player} className="attendance-card">
                                        <div className="attendance-name">{player}</div>
                                        <div className="attendance-count">{totalAttendance}</div>
                                        <div className="attendance-weeks">
                                            {weeksAttended} of 13 weeks
                                        </div>
                                    </div>
                                );
                            })}
                    </div>
                </div>
            );

            const AttendanceEntry = () => {
                const [editableAttendance, setEditableAttendance] = useState(() => {
                    return JSON.parse(JSON.stringify(data.attendanceData));
                });

                const handleAttendanceChange = (player, weekIndex, value) => {
                    const numValue = parseInt(value) || 0;
                    setEditableAttendance(prev => {
                        const updated = { ...prev };
                        updated[player] = [...updated[player]];
                        updated[player][weekIndex] = numValue;
                        return updated;
                    });
                };

                const handleSave = () => {
                    const newData = { ...data };
                    newData.attendanceData = editableAttendance;
                    setData(newData);
                    alert('Attendance data saved!');
                };

                const players = Object.keys(data.attendanceData).sort();

                return (
                    <div className="content-section">
                        <h2 className="section-title">‚úèÔ∏è Edit Attendance ‚úèÔ∏è</h2>
                        
                        <div className="info-banner">
                            Edit attendance for each player. Enter 2 for attended, 0 for missed. Changes save to browser storage.
                        </div>

                        <div className="score-entry-container">
                            <div style={{overflowX: 'auto'}}>
                                <table className="score-entry-table">
                                    <thead>
                                        <tr>
                                            <th>Player</th>
                                            {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13].map(week => (
                                                <th key={week}>Week {week}</th>
                                            ))}
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {players.map((player, idx) => {
                                            const total = editableAttendance[player].reduce((sum, val) => sum + val, 0);
                                            return (
                                                <tr key={idx}>
                                                    <td style={{fontWeight: 'bold', textAlign: 'left', paddingLeft: '15px'}}>
                                                        {player}
                                                    </td>
                                                    {editableAttendance[player].map((value, weekIdx) => (
                                                        <td key={weekIdx}>
                                                            <input
                                                                type="number"
                                                                min="0"
                                                                max="2"
                                                                step="1"
                                                                value={value}
                                                                onChange={(e) => handleAttendanceChange(player, weekIdx, e.target.value)}
                                                                style={{width: '50px'}}
                                                            />
                                                        </td>
                                                    ))}
                                                    <td style={{fontWeight: 'bold', color: '#4ecca3'}}>
                                                        {total}
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            </div>

                            <div style={{textAlign: 'center'}}>
                                <button className="save-button" onClick={handleSave}>
                                    üíæ Save Attendance Data
                                </button>
                            </div>
                        </div>
                    </div>
                );
            };

            const ScoreEntry = () => {
                const [contestantScoring, setContestantScoring] = useState(() => {
                    // Initialize with empty scoring for all contestants
                    const scoring = {};
                    sortedContestants.forEach(contestant => {
                        scoring[contestant.name] = {};
                        scoringCategories.forEach(cat => {
                            scoring[contestant.name][cat.id] = false;
                        });
                    });
                    return scoring;
                });

                const [votedOutThisWeek, setVotedOutThisWeek] = useState(null);

                const handleCheckboxChange = (contestant, categoryId) => {
                    setContestantScoring(prev => ({
                        ...prev,
                        [contestant]: {
                            ...prev[contestant],
                            [categoryId]: !prev[contestant][categoryId]
                        }
                    }));
                };

                const handleVotedOutChange = (contestant) => {
                    setVotedOutThisWeek(contestant);
                };

                const calculateContestantScore = (contestant) => {
                    let total = 0;
                    scoringCategories.forEach(cat => {
                        if (contestantScoring[contestant]?.[cat.id]) {
                            total += cat.points;
                        }
                    });
                    return total;
                };

                const handleSaveAll = () => {
                    const newData = { ...data };
                    const newWeekScores = {};
                    
                    // Calculate score for each contestant
                    sortedContestants.forEach(contestant => {
                        newWeekScores[contestant.name] = calculateContestantScore(contestant.name);
                    });
                    
                    newData.weeklyScores[selectedWeek] = newWeekScores;
                    
                    // Update elimination status if someone was marked as voted out
                    if (votedOutThisWeek) {
                        const contestantIndex = newData.contestants.findIndex(c => c.name === votedOutThisWeek);
                        if (contestantIndex !== -1) {
                            newData.contestants[contestantIndex].eliminated = true;
                            newData.contestants[contestantIndex].eliminatedWeek = selectedWeek;
                            newData.contestants[contestantIndex].tribe = "Voted Out";
                        }
                    }
                    
                    setData(newData);
                    
                    // Reset checkboxes and voted out selection
                    const resetScoring = {};
                    sortedContestants.forEach(contestant => {
                        resetScoring[contestant.name] = {};
                        scoringCategories.forEach(cat => {
                            resetScoring[contestant.name][cat.id] = false;
                        });
                    });
                    setContestantScoring(resetScoring);
                    setVotedOutThisWeek(null);
                    
                    alert(`Week ${selectedWeek} scores saved!${votedOutThisWeek ? ` ${votedOutThisWeek} marked as eliminated.` : ''}`);
                };

                // Filter to only show contestants who are still active for this week
                const activeContestantsForWeek = sortedContestants.filter(contestant => {
                    return !contestant.eliminated || contestant.eliminatedWeek >= selectedWeek;
                }).sort((a, b) => {
                    const tribeOrder = { "Hina": 1, "Kele": 2, "Uli": 3 };
                    const aTribe = a.originalTribe || a.tribe;
                    const bTribe = b.originalTribe || b.tribe;
                    const tribeDiff = tribeOrder[aTribe] - tribeOrder[bTribe];
                    if (tribeDiff !== 0) return tribeDiff;
                    return a.name.localeCompare(b.name);
                });

                return (
                    <div className="content-section">
                        <h2 className="section-title">‚úèÔ∏è Score Entry ‚úèÔ∏è</h2>
                        
                        <div className="info-banner">
                            Check boxes for each contestant's achievements in grid format. Scores calculate automatically!
                        </div>

                        <div className="week-selector">
                            {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13].map(week => (
                                <button
                                    key={week}
                                    className={`week-button ${selectedWeek === week ? 'active' : ''}`}
                                    onClick={() => setSelectedWeek(week)}
                                >
                                    Week {week}
                                </button>
                            ))}
                        </div>

                        <div className="score-entry-container">
                            <div className="info-banner warning" style={{marginTop: '15px'}}>
                                üìä Week {selectedWeek} - Showing {activeContestantsForWeek.length} active contestants
                            </div>

                            <div style={{overflowX: 'auto'}}>
                                <table className="grid-scoring-table">
                                    <thead>
                                        <tr>
                                            <th className="category-header">Scoring Category</th>
                                            {activeContestantsForWeek.map(contestant => {
                                                const displayTribe = contestant.originalTribe || contestant.tribe;
                                                const tribeClass = displayTribe === "Hina" ? "tribe-hina" : 
                                                                 displayTribe === "Kele" ? "tribe-kele" : 
                                                                 displayTribe === "Uli" ? "tribe-uli" : "";
                                                const isEliminatedThisWeek = contestant.eliminated && contestant.eliminatedWeek === selectedWeek;
                                                
                                                return (
                                                    <th 
                                                        key={contestant.name} 
                                                        className="contestant-header"
                                                    >
                                                        <span className={`contestant-tribe ${tribeClass}`} style={{
                                                            padding: '8px 12px',
                                                            borderRadius: '8px',
                                                            display: 'inline-block',
                                                            fontSize: '1em',
                                                            writingMode: 'horizontal-tb',
                                                            whiteSpace: 'nowrap'
                                                        }}>
                                                            {contestant.name}
                                                            {isEliminatedThisWeek && <div style={{color: '#e74c3c', fontSize: '0.75em', marginTop: '3px'}}>üî• OUT</div>}
                                                        </span>
                                                    </th>
                                                );
                                            })}
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {scoringCategories.map(cat => (
                                            <tr key={cat.id}>
                                                <td className="category-header">
                                                    {cat.name}
                                                    <span className={`category-points ${cat.points < 0 ? 'negative' : ''}`}>
                                                        ({cat.points >= 0 ? '+' : ''}{cat.points})
                                                    </span>
                                                </td>
                                                {activeContestantsForWeek.map(contestant => (
                                                    <td key={contestant.name}>
                                                        <input
                                                            type="checkbox"
                                                            checked={contestantScoring[contestant.name]?.[cat.id] || false}
                                                            onChange={() => handleCheckboxChange(contestant.name, cat.id)}
                                                        />
                                                    </td>
                                                ))}
                                            </tr>
                                        ))}
                                        <tr style={{background: 'rgba(231, 76, 60, 0.15)', borderTop: '3px solid #e74c3c'}}>
                                            <td className="category-header" style={{fontWeight: 'bold', color: '#e74c3c'}}>
                                                üî• VOTED OUT THIS WEEK
                                            </td>
                                            {activeContestantsForWeek.map(contestant => {
                                                const isMarkedEliminated = contestant.eliminated && contestant.eliminatedWeek === selectedWeek;
                                                return (
                                                    <td key={contestant.name}>
                                                        <input
                                                            type="radio"
                                                            name={`eliminated-week-${selectedWeek}`}
                                                            checked={isMarkedEliminated}
                                                            style={{width: '20px', height: '20px', cursor: 'pointer'}}
                                                            onChange={() => {}}
                                                            title="Mark as voted out this week"
                                                        />
                                                    </td>
                                                );
                                            })}
                                        </tr>
                                        <tr className="total-row">
                                            <td className="category-header">
                                                <strong>TOTAL POINTS</strong>
                                            </td>
                                            {activeContestantsForWeek.map(contestant => {
                                                const total = calculateContestantScore(contestant.name);
                                                return (
                                                    <td key={contestant.name} className="total-points-cell">
                                                        {total >= 0 ? '+' : ''}{total.toFixed(2)}
                                                    </td>
                                                );
                                            })}
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div style={{textAlign: 'center', marginTop: '30px'}}>
                                <button className="save-button" onClick={handleSaveAll}>
                                    üíæ Save Week {selectedWeek} Scores for All Contestants
                                </button>
                            </div>
                        </div>
                    </div>
                );
            };


            return (
                <div className="app-container">
                    <div className="header">
                        <h1>üî• SURVIVOR 49 üî•</h1>
                        <div className="subtitle">FANTASY LEAGUE TRACKER - SEASON COMPLETE!</div>
                    </div>

                    <div className="navigation">
                        <button 
                            className={`nav-button ${activeView === 'leaderboard' ? 'active' : ''}`}
                            onClick={() => setActiveView('leaderboard')}
                        >
                            üèÜ Leaderboard
                        </button>
                        <button 
                            className={`nav-button ${activeView === 'draft' ? 'active' : ''}`}
                            onClick={() => setActiveView('draft')}
                        >
                            üìã Draft Board
                        </button>
                        <button 
                            className={`nav-button ${activeView === 'contestants' ? 'active' : ''}`}
                            onClick={() => setActiveView('contestants')}
                        >
                            üå¥ Contestants
                        </button>
                        <button 
                            className={`nav-button ${activeView === 'weekly' ? 'active' : ''}`}
                            onClick={() => setActiveView('weekly')}
                        >
                            üìä Weekly Scores
                        </button>
                        <button 
                            className={`nav-button ${activeView === 'eliminations' ? 'active' : ''}`}
                            onClick={() => setActiveView('eliminations')}
                        >
                            üî• Eliminations
                        </button>
                        <button 
                            className={`nav-button ${activeView === 'attendance' ? 'active' : ''}`}
                            onClick={() => setActiveView('attendance')}
                        >
                            üìÖ Attendance
                        </button>
                        <button 
                            className={`nav-button ${activeView === 'attendanceEntry' ? 'active' : ''}`}
                            onClick={() => setActiveView('attendanceEntry')}
                        >
                            ‚úèÔ∏è Edit Attendance
                        </button>
                        <button 
                            className={`nav-button ${activeView === 'entry' ? 'active' : ''}`}
                            onClick={() => setActiveView('entry')}
                        >
                            ‚úèÔ∏è Score Entry
                        </button>
                    </div>

                    {activeView === 'leaderboard' && renderLeaderboard()}
                    {activeView === 'draft' && renderDraftBoard()}
                    {activeView === 'contestants' && renderContestants()}
                    {activeView === 'weekly' && renderWeeklyScores()}
                    {activeView === 'eliminations' && renderEliminations()}
                    {activeView === 'attendance' && renderAttendance()}
                    {activeView === 'attendanceEntry' && <AttendanceEntry />}
                    {activeView === 'entry' && <ScoreEntry />}
                </div>
            );
        };

        ReactDOM.render(<SurvivorLeague />, document.getElementById('root'));
    </script>
</body>
</html>
