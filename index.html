<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survivor 50 Fantasy League</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Cinzel:wght@400;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .app-container { max-width: 1800px; margin: 0 auto; }

        /* ‚îÄ‚îÄ WELCOME PAGE ‚îÄ‚îÄ */
        .welcome-wrap {
            max-width: 700px;
            margin: 0 auto;
            padding: 20px 0 60px;
            font-family: 'Inter', sans-serif;
        }
        .welcome-header { text-align: center; margin-bottom: 48px; }
        .welcome-torch { font-size: 60px; display: block; margin-bottom: 14px;
            animation: torchFlicker 2.5s ease-in-out infinite alternate; }
        @keyframes torchFlicker {
            0%,100% { transform: scale(1) rotate(-2deg); filter: brightness(1); }
            50%      { transform: scale(1.05) rotate(2deg); filter: brightness(1.3); }
        }
        .welcome-badge {
            font-family: 'Bebas Neue', sans-serif; font-size: 11px; letter-spacing: 5px;
            color: #D4A017; margin-bottom: 8px; opacity: .8;
        }
        .welcome-h1 {
            font-family: 'Cinzel', serif; font-size: clamp(48px,10vw,80px);
            font-weight: 700; line-height: .93;
            background: linear-gradient(135deg, #D4A017 0%, #FF4500 50%, #FF8C00 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; margin-bottom: 10px;
        }
        .welcome-sub {
            font-family: 'Bebas Neue', sans-serif; font-size: 17px;
            letter-spacing: 4px; color: #F5E6C8; opacity: .65;
        }
        .welcome-divider {
            width: 80px; height: 2px; margin: 22px auto 0;
            background: linear-gradient(90deg, transparent, #D4A017, transparent);
        }
        .congrats-box {
            background: linear-gradient(135deg, rgba(212,160,23,.13), rgba(255,69,0,.08));
            border: 1px solid rgba(212,160,23,.4); border-radius: 4px;
            padding: 18px 26px; margin-bottom: 36px; text-align: center; position: relative; overflow: hidden;
        }
        .congrats-box::before {
            content:''; position: absolute; top:0; left:0; right:0; height:2px;
            background: linear-gradient(90deg, #D4A017, #FF4500, #D4A017);
        }
        .congrats-label { font-family:'Bebas Neue',sans-serif; font-size:11px; letter-spacing:4px; color:#D4A017; margin-bottom:6px; }
        .congrats-box p { font-size:15px; line-height:1.6; color:#F5E6C8; }
        .congrats-box strong { color:#D4A017; font-weight:500; }
        .welcome-intro {
            font-size: 15px; line-height: 1.75; color: rgba(245,230,200,.82);
            margin-bottom: 40px; padding-left: 14px;
            border-left: 2px solid rgba(255,69,0,.4);
        }
        .w-section { margin-bottom: 36px; }
        .w-sec-header { display:flex; align-items:center; gap:10px; margin-bottom:14px; }
        .w-sec-icon { font-size:20px; flex-shrink:0; }
        .w-sec-title { font-family:'Cinzel',serif; font-size:14px; font-weight:700; letter-spacing:1px; color:#D4A017; text-transform:uppercase; }
        .w-sec-line { flex:1; height:1px; background:linear-gradient(90deg, rgba(212,160,23,.4), transparent); }
        .w-card {
            background: rgba(255,255,255,.04); border: 1px solid rgba(255,255,255,.08);
            border-radius: 4px; padding: 22px;
        }
        .prize-grid { display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin-bottom:14px; }
        .prize-item { text-align:center; padding:14px 8px; background:rgba(0,0,0,.3); border-radius:4px; border:1px solid rgba(212,160,23,.15); }
        .prize-place { font-family:'Bebas Neue',sans-serif; font-size:12px; letter-spacing:2px; color:#D4A017; opacity:.7; margin-bottom:4px; }
        .prize-amt { font-family:'Cinzel',serif; font-size:24px; font-weight:700; }
        .prize-amt.gold  { color:#D4A017; }
        .prize-amt.silver{ color:#C0C0C0; }
        .prize-amt.bronze{ color:#CD7F32; }
        .buy-in-note { font-size:13px; color:rgba(245,230,200,.6); text-align:center; }
        .buy-in-note strong { color:#FF8C00; font-weight:500; }
        .info-list { list-style:none; display:flex; flex-direction:column; gap:10px; }
        .info-list li { font-size:14px; line-height:1.6; color:rgba(245,230,200,.8); padding-left:18px; position:relative; }
        .info-list li::before { content:'‚Ä∫'; position:absolute; left:0; color:#FF4500; font-size:17px; line-height:1.4; }
        .info-list strong { color:#F5E6C8; font-weight:500; }
        .doodle-link {
            display:flex; align-items:center; gap:10px; margin-top:14px;
            background:linear-gradient(135deg,rgba(255,69,0,.18),rgba(212,160,23,.13));
            border:1px solid rgba(255,69,0,.3); border-radius:4px; padding:14px 18px;
            text-decoration:none; color:#F5E6C8; font-size:13px;
            transition: all .2s; word-break:break-all;
        }
        .doodle-link:hover { background:linear-gradient(135deg,rgba(255,69,0,.28),rgba(212,160,23,.22)); }
        .doodle-label { font-family:'Bebas Neue',sans-serif; letter-spacing:2px; font-size:11px; color:#FF4500; white-space:nowrap; flex-shrink:0; }
        .score-tbl { width:100%; border-collapse:collapse; font-size:13px; }
        .score-tbl tr { border-bottom:1px solid rgba(255,255,255,.06); }
        .score-tbl tr:last-child { border-bottom:none; }
        .score-tbl td { padding:9px 8px; color:rgba(245,230,200,.75); line-height:1.4; }
        .score-tbl td:last-child { text-align:right; font-family:'Cinzel',serif; font-size:14px; color:#D4A017; white-space:nowrap; }
        .score-cat { font-family:'Bebas Neue',sans-serif; font-size:10px; letter-spacing:3px; color:#FF4500; padding:14px 8px 5px !important; opacity:.8; }
        .score-cat:first-child { padding-top:5px !important; }
        .new-rule { background:rgba(255,69,0,.07); border-left:2px solid #FF4500; }
        .new-rule td:first-child::after { content:' üÜï'; font-size:10px; }
        .selfie-box {
            background:rgba(212,160,23,.06); border:1px dashed rgba(212,160,23,.3);
            border-radius:4px; padding:18px 22px; text-align:center;
        }
        .selfie-box p { font-size:14px; line-height:1.6; color:rgba(245,230,200,.8); }
        .selfie-box strong { color:#D4A017; font-weight:500; }
        .enter-btn {
            display: block; margin: 48px auto 0; padding: 18px 60px;
            font-family: 'Cinzel', serif; font-size: 18px; font-weight: 700;
            letter-spacing: 2px; text-transform: uppercase;
            background: linear-gradient(135deg, #FF4500, #D4A017);
            border: none; border-radius: 4px; color: white; cursor: pointer;
            box-shadow: 0 8px 30px rgba(255,69,0,.4);
            transition: all .3s;
        }
        .enter-btn:hover { transform: translateY(-3px); box-shadow: 0 12px 40px rgba(255,69,0,.5); }
        .welcome-footer { text-align:center; margin-top:50px; padding-top:28px; border-top:1px solid rgba(255,255,255,.06); }
        .welcome-footer span { font-size:28px; display:block; margin-bottom:10px; }
        .welcome-footer p { font-family:'Cinzel',serif; font-size:13px; color:rgba(212,160,23,.5); letter-spacing:1px; }
        .welcome-footer small { font-family:'Inter',sans-serif; font-size:11px; font-weight:300; color:rgba(245,230,200,.3); letter-spacing:.3px; display:block; margin-top:10px; }

        /* ‚îÄ‚îÄ TRACKER STYLES (from S49 with tribe updates) ‚îÄ‚îÄ */
        .header {
            text-align: center; margin-bottom: 40px; padding: 30px;
            background: linear-gradient(135deg, #1abc9c 0%, #9b59b6 50%, #e67e22 100%);
            border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .header h1 { font-size: 3.5em; text-shadow: 3px 3px 6px rgba(0,0,0,0.5); margin-bottom: 10px; font-weight: bold; letter-spacing: 2px; }
        .header .subtitle { font-size: 2em; opacity: .95; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); font-weight: bold; letter-spacing: 3px; }

        .navigation { display: flex; justify-content: center; gap: 12px; margin-bottom: 30px; flex-wrap: wrap; }
        .nav-button {
            padding: 12px 24px; font-size: 1em; font-weight: bold; border: none;
            border-radius: 25px; cursor: pointer; transition: all .3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); color: white;
        }
        .nav-button:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.3); }
        .nav-button.active { transform: scale(1.05); box-shadow: 0 6px 25px rgba(0,0,0,0.4); }
        .nav-button:nth-child(1) { background: linear-gradient(135deg, #FF4500, #D4A017); }
        .nav-button:nth-child(2) { background: linear-gradient(135deg, #f39c12, #e67e22); }
        .nav-button:nth-child(3) { background: linear-gradient(135deg, #3498db, #2980b9); }
        .nav-button:nth-child(4) { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .nav-button:nth-child(5) { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .nav-button:nth-child(6) { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .nav-button:nth-child(7) { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
        .nav-button:nth-child(8) { background: linear-gradient(135deg, #16a085, #1abc9c); }

        .content-section {
            background: rgba(255,255,255,.05); backdrop-filter: blur(10px);
            border-radius: 15px; padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,.1);
        }
        .section-title {
            font-size: 2em; margin-bottom: 25px; text-align: center;
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: bold;
        }

        /* Leaderboard */
        .leaderboard { display: grid; gap: 15px; }
        .leaderboard-item {
            display: grid; grid-template-columns: 60px 1fr 120px;
            align-items: center; padding: 20px; background: rgba(255,255,255,.08);
            border-radius: 10px; transition: all .3s; border-left: 5px solid transparent;
        }
        .leaderboard-item:hover { background: rgba(255,255,255,.12); transform: translateX(5px); }
        .leaderboard-item.rank-1 { border-left-color:#f1c40f; background:linear-gradient(90deg,rgba(241,196,15,.3) 0%,rgba(255,255,255,.08) 100%); }
        .leaderboard-item.rank-2 { border-left-color:#c0c0c0; background:linear-gradient(90deg,rgba(192,192,192,.3) 0%,rgba(255,255,255,.08) 100%); }
        .leaderboard-item.rank-3 { border-left-color:#cd7f32; background:linear-gradient(90deg,rgba(205,127,50,.3) 0%,rgba(255,255,255,.08) 100%); }
        .leaderboard-item.tier-teal  { border-left-color:#1abc9c; background:linear-gradient(90deg,rgba(26,188,156,.2) 0%,rgba(255,255,255,.08) 100%); }
        .leaderboard-item.tier-blue  { border-left-color:#3498db; background:linear-gradient(90deg,rgba(52,152,219,.2) 0%,rgba(255,255,255,.08) 100%); }
        .leaderboard-item.tier-orange{ border-left-color:#f39c12; background:linear-gradient(90deg,rgba(243,156,18,.2) 0%,rgba(255,255,255,.08) 100%); }
        .leaderboard-item.tier-red   { border-left-color:#e74c3c; background:linear-gradient(90deg,rgba(231,76,60,.2) 0%,rgba(255,255,255,.08) 100%); }
        .rank { font-size:2em; font-weight:bold; text-align:center; }
        .player-name { font-size:1.4em; font-weight:bold; }
        .player-stats { display:flex; gap:15px; font-size:.9em; color:#bbb; flex-wrap:wrap; }
        .total-points { font-size:1.8em; font-weight:bold; text-align:right; color:#4ecca3; }

        /* Tribes */
        .tribe-cila { background:linear-gradient(135deg,#1abc9c 0%,#16a085 100%); color:white; font-weight:bold; }
        .tribe-kalo { background:linear-gradient(135deg,#9b59b6 0%,#8e44ad 100%); color:white; font-weight:bold; }
        .tribe-vatu { background:linear-gradient(135deg,#e67e22 0%,#d35400 100%); color:white; font-weight:bold; }
        .eliminated { background:#555 !important; opacity:.55; }

        /* Draft Board */
        .draft-board { overflow-x: auto; }
        .draft-table { width:100%; border-collapse:collapse; min-width:900px; }
        .draft-table th { background:rgba(255,255,255,.1); padding:15px 10px; font-size:1.1em; border:1px solid rgba(255,255,255,.1); position:sticky; top:0; z-index:10; }
        .draft-table td { padding:12px 10px; border:1px solid rgba(255,255,255,.1); text-align:center; font-size:1em; font-weight:500; }
        .draft-table tr:hover { background:rgba(255,255,255,.05); }
        .draft-table th.sortable { cursor:pointer; user-select:none; }
        .draft-table th.sortable:hover { background:rgba(255,255,255,.15); }
        .draft-table th.sortable::after { content:' ‚áÖ'; opacity:.5; }
        .draft-table th.sorted-asc::after { content:' ‚Üë'; opacity:1; }
        .draft-table th.sorted-desc::after { content:' ‚Üì'; opacity:1; }
        .contestant-cell { transition:all .2s; }
        .contestant-cell:hover { transform:scale(1.05); }

        /* Contestant Grid */
        .contestant-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:18px; margin-top:20px; }
        .contestant-card {
            background:rgba(255,255,255,.08); border-radius:12px; padding:15px;
            text-align:center; transition:all .3s; border:3px solid transparent; cursor:pointer;
        }
        .contestant-card:hover { transform:translateY(-5px); box-shadow:0 10px 25px rgba(0,0,0,0.3); }
        .contestant-card.tribe-cila { border-color:#1abc9c; }
        .contestant-card.tribe-kalo { border-color:#9b59b6; }
        .contestant-card.tribe-vatu { border-color:#e67e22; }
        .contestant-card.eliminated { opacity:.4; filter:grayscale(100%); }
        .contestant-name { font-size:1.2em; font-weight:bold; margin-bottom:8px; }
        .contestant-tribe { padding:5px 10px; border-radius:15px; font-size:.85em; display:inline-block; margin-bottom:8px; }
        .contestant-points { font-size:1.4em; color:#4ecca3; font-weight:bold; }

        /* Weekly Scores */
        .week-selector { display:flex; justify-content:center; gap:8px; margin-bottom:25px; flex-wrap:wrap; }
        .week-button {
            padding:10px 18px; font-size:.95em; font-weight:bold;
            border:2px solid rgba(255,255,255,.3); background:rgba(255,255,255,.05);
            color:white; border-radius:8px; cursor:pointer; transition:all .3s;
        }
        .week-button:hover { background:rgba(255,255,255,.15); border-color:rgba(255,255,255,.5); }
        .week-button.active { background:linear-gradient(135deg,#4ecca3,#00b894); border-color:#4ecca3; transform:scale(1.05); }
        .scoring-table { width:100%; border-collapse:collapse; margin-top:20px; }
        .scoring-table th, .scoring-table td { padding:10px; border:1px solid rgba(255,255,255,.1); text-align:center; font-size:.95em; }
        .scoring-table th { background:rgba(255,255,255,.1); font-weight:bold; position:sticky; top:0; z-index:5; cursor:pointer; user-select:none; }
        .scoring-table th:hover { background:rgba(255,255,255,.15); }
        .scoring-table th.sortable::after { content:' ‚áÖ'; opacity:.5; }
        .scoring-table th.sorted-asc::after { content:' ‚Üë'; opacity:1; }
        .scoring-table th.sorted-desc::after { content:' ‚Üì'; opacity:1; }
        .scoring-table tr:hover { background:rgba(255,255,255,.05); }
        .points-value { font-weight:bold; }
        .positive-points { color:#4ecca3; }
        .negative-points { color:#e74c3c; }

        /* Grid Scoring */
        .grid-scoring-table { width:100%; border-collapse:collapse; margin-top:20px; font-size:.9em; }
        .grid-scoring-table th, .grid-scoring-table td { border:1px solid rgba(255,255,255,.2); padding:10px 8px; text-align:center; }
        .grid-scoring-table th { background:rgba(255,255,255,.15); font-weight:bold; position:sticky; top:0; z-index:10; backdrop-filter:blur(10px); }
        .grid-scoring-table .category-header { text-align:left; padding-left:15px; min-width:300px; background:rgba(255,255,255,.08); }
        .grid-scoring-table .contestant-header { min-width:80px; writing-mode:vertical-rl; text-orientation:mixed; padding:15px 8px; font-size:1.05em; }
        .grid-scoring-table tr:hover { background:rgba(255,255,255,.05); }
        .grid-scoring-table .total-row { background:rgba(78,204,163,.15); font-weight:bold; font-size:1.1em; }
        .grid-scoring-table .total-points-cell { color:#4ecca3; font-size:1.2em; }
        .grid-scoring-table .category-points { color:#4ecca3; font-size:.85em; font-weight:bold; margin-left:8px; }
        .grid-scoring-table .category-points.negative { color:#e74c3c; }
        .checkbox-visual { width:20px; height:20px; border-radius:3px; display:inline-flex; align-items:center; justify-content:center; border:2px solid rgba(255,255,255,.3); }
        .checkbox-visual.checked { background:#4ecca3; border-color:#4ecca3; }
        .checkbox-visual.checked::after { content:'‚úì'; color:white; font-weight:bold; font-size:14px; }

        /* Attendance */
        .attendance-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:15px; margin-top:20px; }
        .attendance-card { background:rgba(255,255,255,.08); border-radius:10px; padding:18px; text-align:center; transition:all .3s; }
        .attendance-card:hover { background:rgba(255,255,255,.12); transform:translateY(-3px); }
        .attendance-name { font-size:1.1em; font-weight:bold; margin-bottom:8px; }
        .attendance-count { font-size:2em; color:#4ecca3; font-weight:bold; }
        .attendance-weeks { margin-top:8px; font-size:.82em; color:#bbb; }

        /* Tribe legend */
        .tribe-legend { display:flex; justify-content:center; gap:28px; margin:20px 0; flex-wrap:wrap; }
        .legend-item { display:flex; align-items:center; gap:8px; font-size:1.05em; font-weight:bold; }
        .legend-color { width:28px; height:28px; border-radius:5px; }

        /* Summary stats */
        .summary-stats { display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:18px; margin-top:20px; }
        .stat-card { background:rgba(255,255,255,.08); border-radius:12px; padding:18px; text-align:center; }
        .stat-value { font-size:2.5em; font-weight:bold; color:#4ecca3; margin:8px 0; }
        .stat-label { font-size:1em; color:#bbb; }

        /* Eliminations */
        .elimination-timeline { display:flex; flex-direction:column; gap:18px; margin-top:20px; }
        .elimination-item { background:rgba(255,255,255,.08); border-radius:12px; padding:18px; border-left:5px solid #e74c3c; transition:all .3s; }
        .elimination-item:hover { background:rgba(255,255,255,.12); transform:translateX(5px); }
        .elimination-item.medical { border-left-color:#f39c12; background:linear-gradient(90deg,rgba(243,156,18,.15) 0%,rgba(255,255,255,.08) 100%); }
        .elimination-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
        .elimination-week { font-size:1.4em; font-weight:bold; color:#4ecca3; }
        .elimination-name { font-size:1.7em; font-weight:bold; }
        .elimination-badge { padding:5px 14px; border-radius:20px; font-size:.9em; font-weight:bold; }
        .elimination-badge.voted { background:linear-gradient(135deg,#e74c3c,#c0392b); }
        .elimination-badge.medical { background:linear-gradient(135deg,#f39c12,#e67e22); }
        .elimination-reason { font-size:1em; line-height:1.6; color:#ddd; margin-top:8px; }

        /* Winner Circles */
        .winner-circles-grid { display:grid; gap:28px; margin-top:20px; }
        .season-card { background:rgba(255,255,255,.08); border-radius:15px; padding:28px; border:2px solid rgba(255,255,255,.1); transition:all .3s; }
        .season-card:hover { transform:translateY(-5px); box-shadow:0 10px 30px rgba(0,0,0,0.3); border-color:rgba(255,215,0,.3); }
        .season-header { font-size:1.8em; font-weight:bold; text-align:center; margin-bottom:22px; color:#4ecca3; text-shadow:0 2px 10px rgba(78,204,163,.3); }
        .podium { display:grid; grid-template-columns:1fr 1fr 1fr; gap:18px; align-items:flex-end; }
        .podium-position { text-align:center; padding:18px; border-radius:12px; transition:all .3s; }
        .podium-position:hover { transform:scale(1.05); }
        .podium-first  { background:linear-gradient(135deg,rgba(241,196,15,.3),rgba(243,156,18,.2)); border:3px solid #f1c40f; grid-column:2; padding-top:28px; padding-bottom:28px; }
        .podium-second { background:linear-gradient(135deg,rgba(149,165,166,.3),rgba(127,140,141,.2)); border:3px solid #95a5a6; grid-column:1; }
        .podium-third  { background:linear-gradient(135deg,rgba(205,127,50,.3),rgba(184,115,51,.2)); border:3px solid #cd7f32; grid-column:3; }
        .podium-rank { font-size:2.8em; margin-bottom:8px; }
        .podium-label { font-size:.85em; text-transform:uppercase; letter-spacing:2px; color:#bbb; margin-bottom:8px; }
        .podium-name { font-size:1.7em; font-weight:bold; }
        .podium-first .podium-rank { font-size:3.8em; }
        .podium-first .podium-name { font-size:2em; }

        /* Info banner */
        .info-banner { background:rgba(78,204,163,.15); border:1px solid rgba(78,204,163,.3); border-radius:10px; padding:14px 18px; margin-bottom:18px; text-align:center; }
        .info-banner.warning { background:rgba(243,156,18,.15); border-color:rgba(243,156,18,.3); }

        /* Score entry table */
        .score-entry-table { width:100%; border-collapse:collapse; margin-top:20px; }
        .score-entry-table th, .score-entry-table td { padding:12px 8px; border:1px solid rgba(255,255,255,.1); text-align:center; }
        .score-entry-table th { background:rgba(255,255,255,.1); font-weight:bold; font-size:.95em; position:sticky; top:0; z-index:10; backdrop-filter:blur(10px); }

        @media (max-width:768px) {
            .header .subtitle { font-size:1.2em; }
            .leaderboard-item { grid-template-columns:50px 1fr 80px; font-size:.9em; padding:14px; }
            .player-stats { display:none; }
            .nav-button { padding:10px 16px; font-size:.9em; }
        }
    </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect, useMemo } = React;

const ALL_CONTESTANTS = [
    "Rick","Jenna","Cirie","Emily","Christian","Joe H","Savannah","Ozzy",
    "Charlie","Tiffany","Chrissy","Kamilla","Dee","Coach","Mike","Jonathan",
    "Angelina","Aubry","Q","Colby","Kyle","Stephenie","Genevieve","Rizo"
];

const scoringCategories = [
    { id:'team_reward',        name:'Won team reward (worth nothing if combined)',            points: 1 },
    { id:'team_immunity',      name:'Won team immunity',                                      points: 1 },
    { id:'second_team_immunity',name:'Second in team immunity',                               points: 0.5 },
    { id:'individual_reward',  name:'Won individual reward (worth nothing if combined)',       points: 2 },
    { id:'individual_immunity',name:'Won individual immunity',                                points: 2 },
    { id:'taken_reward',       name:'Taken on individual reward',                             points: 1 },
    { id:'mini_reward',        name:'Mini reward victory',                                    points: 0.5 },
    { id:'title_quote',        name:'Episode title quote',                                    points: 0.25 },
    { id:'idol_tribal',        name:'Has idol at end of episode and was at tribal',           points: 1 },
    { id:'idol_used',          name:'Uses idol (or successful dice)',                         points: 0.5 },
    { id:'voted_idol',         name:'Voted off with idol',                                    points: -3 },
    { id:'advantage_held',     name:'Holds any advantage at end of episode (not idol)',       points: 0.5, isNew: true },
    { id:'premerge_survive',   name:'Pre-merge surviving an elimination',                     points: 0.75 },
    { id:'postmerge_survive',  name:'Post-merge surviving an elimination',                    points: 1 },
    { id:'shot_in_dark',       name:'Goes home with shot in the dark',                       points: -0.5 },
    { id:'quits',              name:'Quits',                                                  points: -3 },
    { id:'final_group',        name:'Made final group',                                       points: 2 },
    { id:'vote_final',         name:'Vote in final group',                                    points: 0.5 },
    { id:'won_survivor',       name:'Won survivor',                                           points: 7.5 }
];

const TOTAL_WEEKS = 15;

function makeEmptyWeekScores() {
    const ws = {};
    for (let w = 1; w <= TOTAL_WEEKS; w++) {
        ws[w] = {};
        ALL_CONTESTANTS.forEach(n => { ws[w][n] = 0; });
    }
    return ws;
}

function makeEmptyCheckboxStates() {
    const cb = {};
    for (let w = 1; w <= TOTAL_WEEKS; w++) {
        cb[w] = {};
        ALL_CONTESTANTS.forEach(n => { cb[w][n] = {}; });
    }
    return cb;
}

const SurvivorLeague = () => {
    const [activeView, setActiveView] = useState('welcome');
    const [selectedWeek, setSelectedWeek] = useState(1);
    const [sortConfig, setSortConfig] = useState({ key: null, direction: 'desc' });
    const [draftSortConfig, setDraftSortConfig] = useState({ key: 'left', direction: 'desc' });

    const getInitialData = () => {
        const DATA_VERSION = 1; // Season 50 fresh start
        const savedVersion = localStorage.getItem('survivor50DataVersion');
        if (savedVersion != DATA_VERSION) {
            localStorage.removeItem('survivor50LeagueData');
            localStorage.setItem('survivor50DataVersion', DATA_VERSION);
        }
        const savedData = localStorage.getItem('survivor50LeagueData');
        if (savedData && savedVersion == DATA_VERSION) return JSON.parse(savedData);

        return {
            contestants: [
                // ‚îÄ‚îÄ CILA TRIBE (Teal) ‚îÄ‚îÄ
                { name:"Rick",      tribe:"Cila", originalTribe:"Cila", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Jenna",     tribe:"Cila", originalTribe:"Cila", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Cirie",     tribe:"Cila", originalTribe:"Cila", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Emily",     tribe:"Cila", originalTribe:"Cila", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Christian", tribe:"Cila", originalTribe:"Cila", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Joe H",     tribe:"Cila", originalTribe:"Cila", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Savannah",  tribe:"Cila", originalTribe:"Cila", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Ozzy",      tribe:"Cila", originalTribe:"Cila", eliminated:false, eliminatedWeek:null, advantages:[] },
                // ‚îÄ‚îÄ KALO TRIBE (Purple) ‚îÄ‚îÄ
                { name:"Charlie",   tribe:"Kalo", originalTribe:"Kalo", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Tiffany",   tribe:"Kalo", originalTribe:"Kalo", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Chrissy",   tribe:"Kalo", originalTribe:"Kalo", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Kamilla",   tribe:"Kalo", originalTribe:"Kalo", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Dee",       tribe:"Kalo", originalTribe:"Kalo", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Coach",     tribe:"Kalo", originalTribe:"Kalo", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Mike",      tribe:"Kalo", originalTribe:"Kalo", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Jonathan",  tribe:"Kalo", originalTribe:"Kalo", eliminated:false, eliminatedWeek:null, advantages:[] },
                // ‚îÄ‚îÄ VATU TRIBE (Orange) ‚îÄ‚îÄ
                { name:"Angelina",  tribe:"Vatu", originalTribe:"Vatu", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Aubry",     tribe:"Vatu", originalTribe:"Vatu", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Q",         tribe:"Vatu", originalTribe:"Vatu", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Colby",     tribe:"Vatu", originalTribe:"Vatu", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Kyle",      tribe:"Vatu", originalTribe:"Vatu", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Stephenie", tribe:"Vatu", originalTribe:"Vatu", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Genevieve", tribe:"Vatu", originalTribe:"Vatu", eliminated:false, eliminatedWeek:null, advantages:[] },
                { name:"Rizo",      tribe:"Vatu", originalTribe:"Vatu", eliminated:false, eliminatedWeek:null, advantages:[] },
            ],
            weeklyScores: makeEmptyWeekScores(),
            weeklyCheckboxStates: makeEmptyCheckboxStates(),
            draftData: [
                { player:"Dan",       picks:["","","","","",""], left:0 },
                { player:"Julie",     picks:["","","","","",""], left:0 },
                { player:"Lindsay",   picks:["","","","","",""], left:0 },
                { player:"Brett/Emma",picks:["","","","","",""], left:0 },
                { player:"Jack",      picks:["","","","","",""], left:0 },
                { player:"Gab",       picks:["","","","","",""], left:0 },
                { player:"Neil",      picks:["","","","","",""], left:0 },
                { player:"Jenny",     picks:["","","","","",""], left:0 },
                { player:"David",     picks:["","","","","",""], left:0 },
                { player:"Sue",       picks:["","","","","",""], left:0 },
                { player:"Ryan",      picks:["","","","","",""], left:0 },
                { player:"Jason",     picks:["","","","","",""], left:0 },
                { player:"Alex",      picks:["","","","","",""], left:0 },
                { player:"Debbie",    picks:["","","","","",""], left:0 },
                { player:"Jenn",      picks:["","","","","",""], left:0 },
                { player:"Mel",       picks:["","","","","",""], left:0 },
            ],
            attendanceData: {
                "Dan":[],"Julie":[],"Lindsay":[],"Brett/Emma":[],"Jack":[],
                "Gab":[],"Neil":[],"Jenny":[],"David":[],"Sue":[],
                "Ryan":[],"Jason":[],"Alex":[],"Debbie":[],"Jenn":[],"Mel":[]
            },
            eliminationTimeline: [],
            winnerCircles: [
                { season:49, first:"Dan",   second:"Alex",    third:"Jenny" },
                { season:48, first:"Julie", second:"Jack",    third:"Gab" },
                { season:47, first:"Ian",   second:"Neil",    third:"Julie" },
                { season:46, first:"Julie", second:"Lindsay", third:"Jenn" },
                { season:45, first:"Ryan",  second:"Ian",     third:null }
            ],
            surveyPoints: {
                "Dan":0,"Julie":0,"Lindsay":0,"Brett/Emma":0,"Jack":0,
                "Gab":0,"Neil":0,"Jenny":0,"David":0,"Sue":0,
                "Ryan":0,"Jason":0,"Alex":0,"Debbie":0,"Jenn":0,"Mel":0
            }
        };
    };

    const [data, setData] = useState(() => getInitialData());
    useEffect(() => { localStorage.setItem('survivor50LeagueData', JSON.stringify(data)); }, [data]);

    const contestantTotals = useMemo(() => {
        const totals = {};
        data.contestants.forEach(c => {
            let t = 0;
            for (let w = 1; w <= TOTAL_WEEKS; w++) t += (data.weeklyScores[w] && data.weeklyScores[w][c.name]) || 0;
            totals[c.name] = t;
        });
        return totals;
    }, [data.weeklyScores, data.contestants]);

    const sortedContestants = useMemo(() => {
        return [...data.contestants].sort((a, b) => {
            const tribeOrder = { "Winner":1,"Finalist":2,"Cila":3,"Kalo":4,"Vatu":5,"Voted Out":6 };
            const diff = (tribeOrder[a.tribe]||99)-(tribeOrder[b.tribe]||99);
            return diff !== 0 ? diff : a.name.localeCompare(b.name);
        });
    }, [data.contestants]);

    const leaderboard = useMemo(() => {
        const scores = data.draftData.map(entry => {
            let contestantPoints = 0, attendancePoints = 0, surveyPoints = 0;
            entry.picks.forEach(pick => { if(pick) contestantPoints += contestantTotals[pick] || 0; });
            if (data.attendanceData[entry.player]) attendancePoints = data.attendanceData[entry.player].reduce((s,v)=>s+v,0);
            if (data.surveyPoints && data.surveyPoints[entry.player]) surveyPoints = data.surveyPoints[entry.player];
            return { player:entry.player, totalPoints:contestantPoints+attendancePoints+surveyPoints, contestantPoints, attendancePoints, surveyPoints, contestantsLeft:entry.left };
        });
        return scores.sort((a,b)=>b.totalPoints-a.totalPoints);
    }, [contestantTotals, data.draftData, data.attendanceData, data.surveyPoints]);

    const handleSort = key => {
        let dir = 'desc';
        if (sortConfig.key===key && sortConfig.direction==='desc') dir='asc';
        setSortConfig({key,direction:dir});
    };

    const getTribeCss = tribe => {
        if (!tribe) return '';
        const t = tribe.toLowerCase();
        if (t==='cila') return 'tribe-cila';
        if (t==='kalo') return 'tribe-kalo';
        if (t==='vatu') return 'tribe-vatu';
        return '';
    };

    const getSortedWeeklyData = () => {
        let sorted = sortedContestants.filter(c => !c.eliminated || c.eliminatedWeek >= selectedWeek);
        if (sortConfig.key==='name') sorted.sort((a,b)=>{ const r=a.name.localeCompare(b.name); return sortConfig.direction==='asc'?r:-r; });
        else if (sortConfig.key==='weekPoints') sorted.sort((a,b)=>{ const ap=(data.weeklyScores[selectedWeek]&&data.weeklyScores[selectedWeek][a.name])||0; const bp=(data.weeklyScores[selectedWeek]&&data.weeklyScores[selectedWeek][b.name])||0; return sortConfig.direction==='asc'?ap-bp:bp-ap; });
        else if (sortConfig.key==='totalPoints') sorted.sort((a,b)=>{ let at=0,bt=0; for(let w=1;w<=selectedWeek;w++){at+=(data.weeklyScores[w]&&data.weeklyScores[w][a.name])||0; bt+=(data.weeklyScores[w]&&data.weeklyScores[w][b.name])||0;} return sortConfig.direction==='asc'?at-bt:bt-at; });
        return sorted;
    };

    // ‚îÄ‚îÄ‚îÄ WELCOME VIEW ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const renderWelcome = () => (
        <div className="welcome-wrap">
            <div className="welcome-header">
                <span className="welcome-torch">üî•</span>
                <div className="welcome-badge">Fantasy League ¬∑ All Veterans</div>
                <div className="welcome-h1">SURVIVOR<br/>50</div>
                <div className="welcome-sub">The Milestone Season</div>
                <div className="welcome-divider"></div>
            </div>

            <div className="congrats-box">
                <div className="congrats-label">üèÜ Season 49 Champion</div>
                <p>A huge congratulations to <strong>Dan</strong> for taking home the victory last season! The torch has been snuffed and reset ‚Äî time to defend the title or steal the crown. üëë</p>
            </div>

            <p className="welcome-intro">
                Welcome back, survivors. Season 50 is a milestone ‚Äî and so is this group. Every single one of you has played before, which means no rookie excuses this time. You know the rules, you know the stakes, and you know how to lose gracefully. Let's go.
            </p>

            <div className="w-section">
                <div className="w-sec-header"><span className="w-sec-icon">üí∞</span><span className="w-sec-title">Buy-In & Prize Pool</span><div className="w-sec-line"></div></div>
                <div className="w-card">
                    <div className="prize-grid">
                        <div className="prize-item"><div className="prize-place">1st Place</div><div className="prize-amt gold">$300</div></div>
                        <div className="prize-item"><div className="prize-place">2nd Place</div><div className="prize-amt silver">$100</div></div>
                        <div className="prize-item"><div className="prize-place">3rd Place</div><div className="prize-amt bronze">$50</div></div>
                    </div>
                    <p className="buy-in-note">$25 buy-in ¬∑ Venmo <strong>@Neil-Edwards17</strong> to lock in your spot ¬∑ $450 base pool</p>
                </div>
            </div>

            <div className="w-section">
                <div className="w-sec-header"><span className="w-sec-icon">üìã</span><span className="w-sec-title">Draft Details</span><div className="w-sec-line"></div></div>
                <div className="w-card">
                    <ul className="info-list">
                        <li>Snake draft held <strong>after the first episode airs</strong> ‚Äî watch it before you draft!</li>
                        <li>Each manager drafts <strong>6 Survivor contestants</strong></li>
                        <li>Any contestant can be drafted by a <strong>maximum of 7 different people</strong></li>
                        <li>24-person expanded cast this season ‚Äî do your research, veterans! üò§</li>
                    </ul>
                    <a className="doodle-link" href="https://doodle.com/group-poll/participate/eZGmKK2a" target="_blank">
                        <span className="doodle-label">üìÖ Schedule Draft</span>
                        <span>doodle.com/group-poll/participate/eZGmKK2a</span>
                    </a>
                </div>
            </div>

            <div className="w-section">
                <div className="w-sec-header"><span className="w-sec-icon">üèÜ</span><span className="w-sec-title">Scoring System</span><div className="w-sec-line"></div></div>
                <div className="w-card">
                    <table className="score-tbl">
                        <tbody>
                            <tr><td className="score-cat" colSpan="2">Challenges</td></tr>
                            <tr><td>Won team reward <span style={{fontSize:'11px',opacity:.55}}>(nothing if combined)</span></td><td>+1 pt</td></tr>
                            <tr><td>Won team immunity</td><td>+1 pt</td></tr>
                            <tr><td>Second in team immunity</td><td>+0.5 pts</td></tr>
                            <tr><td>Won individual reward <span style={{fontSize:'11px',opacity:.55}}>(nothing if combined)</span></td><td>+2 pts</td></tr>
                            <tr><td>Won individual immunity</td><td>+2 pts</td></tr>
                            <tr><td>Taken on individual reward</td><td>+1 pt</td></tr>
                            <tr><td>Mini reward victory</td><td>+0.5 pts</td></tr>
                            <tr><td className="score-cat" colSpan="2">Idols & Advantages</td></tr>
                            <tr><td>Has idol at end of episode and was at tribal</td><td>+1 pt</td></tr>
                            <tr><td>Uses idol or successful dice <span style={{fontSize:'11px',opacity:.55}}>(per vote saved)</span></td><td>+0.5 pts</td></tr>
                            <tr><td>Voted off with idol in pocket</td><td>‚àí3 pts</td></tr>
                            <tr className="new-rule"><td>Holds any advantage at end of episode <span style={{fontSize:'11px',opacity:.55}}>(extra vote, KIP, etc. ‚Äî not idols)</span></td><td>+0.5 pts</td></tr>
                            <tr><td className="score-cat" colSpan="2">Survival</td></tr>
                            <tr><td>Survives an elimination (pre-merge)</td><td>+0.75 pts</td></tr>
                            <tr><td>Survives an elimination (post-merge)</td><td>+1 pt</td></tr>
                            <tr><td>Made final group</td><td>+2 pts</td></tr>
                            <tr><td>Vote in final group</td><td>+0.5 pts</td></tr>
                            <tr><td>Won Survivor</td><td>+7.5 pts</td></tr>
                            <tr><td className="score-cat" colSpan="2">Penalties</td></tr>
                            <tr><td>Goes home with shot in the dark</td><td>‚àí0.5 pts</td></tr>
                            <tr><td>Quits</td><td>‚àí3 pts</td></tr>
                            <tr><td className="score-cat" colSpan="2">Bonus</td></tr>
                            <tr><td>Episode title quote</td><td>+0.25 pts</td></tr>
                            <tr><td>Selfie watching episode</td><td>+2 pts</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div className="w-section">
                <div className="w-sec-header"><span className="w-sec-icon">üì∏</span><span className="w-sec-title">Attendance Bonus</span><div className="w-sec-line"></div></div>
                <div className="selfie-box">
                    <p>Earn <strong>+2 points each week</strong> by sending Neil a selfie while watching the episode live. Watch parties are strongly encouraged and spiritually mandatory. üå¥</p>
                </div>
            </div>

            <button className="enter-btn" onClick={() => setActiveView('leaderboard')}>
                Enter the Tracker ‚Üí
            </button>

            <div className="welcome-footer">
                <span>ü™±üî•</span>
                <p>Season 50 ¬∑ All Veterans ¬∑ May the best team win</p>
                <small>* Prize pool subject to change based on final number of participants.</small>
            </div>
        </div>
    );

    // ‚îÄ‚îÄ‚îÄ LEADERBOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const renderLeaderboard = () => (
        <div className="content-section">
            <h2 className="section-title">üèÜ Current Standings üèÜ</h2>
            <div className="info-banner">Draft pending ‚Äî standings will populate once picks are entered. Selfie & survey points shown.</div>
            <div className="leaderboard">
                {leaderboard.map((entry, index) => {
                    const total = leaderboard.length;
                    let tierClass = index===0?'rank-1':index===1?'rank-2':index===2?'rank-3':
                        index<=Math.ceil(total*.25)?'tier-teal':index<=Math.ceil(total*.5)?'tier-blue':
                        index<=Math.ceil(total*.75)?'tier-orange':'tier-red';
                    return (
                        <div key={entry.player} className={`leaderboard-item ${tierClass}`}>
                            <div className="rank">{index===0?'ü•á':index===1?'ü•à':index===2?'ü•â':`#${index+1}`}</div>
                            <div>
                                <div className="player-name">{entry.player}</div>
                                <div className="player-stats">
                                    <span>Contestants: {entry.contestantPoints.toFixed(2)} pts</span>
                                    <span>Attendance: {entry.attendancePoints} pts</span>
                                    <span>Survey: {entry.surveyPoints} pts</span>
                                </div>
                            </div>
                            <div className="total-points">{entry.totalPoints.toFixed(2)}</div>
                        </div>
                    );
                })}
            </div>
            <div className="summary-stats">
                <div className="stat-card"><div className="stat-label">Current Season</div><div className="stat-value">50</div></div>
                <div className="stat-card"><div className="stat-label">Episodes Aired</div><div className="stat-value">0/{TOTAL_WEEKS}</div></div>
                <div className="stat-card"><div className="stat-label">Cast Size</div><div className="stat-value">24</div></div>
                <div className="stat-card"><div className="stat-label">League Players</div><div className="stat-value">{leaderboard.length}</div></div>
            </div>
        </div>
    );

    // ‚îÄ‚îÄ‚îÄ DRAFT BOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const renderDraftBoard = () => {
        const handleDraftSort = key => {
            let dir='desc';
            if (draftSortConfig.key===key && draftSortConfig.direction==='desc') dir='asc';
            setDraftSortConfig({key,direction:dir});
        };
        const sortedDraft = [...data.draftData].sort((a,b)=>{
            if (draftSortConfig.key==='player') return draftSortConfig.direction==='asc'?a.player.localeCompare(b.player):b.player.localeCompare(a.player);
            if (draftSortConfig.key==='left') {
                if (a.left!==b.left) return draftSortConfig.direction==='asc'?a.left-b.left:b.left-a.left;
                let ap=0,bp=0;
                a.picks.forEach(p=>{if(p) ap+=contestantTotals[p]||0;});
                b.picks.forEach(p=>{if(p) bp+=contestantTotals[p]||0;});
                const aAtt=data.attendanceData[a.player]?data.attendanceData[a.player].reduce((s,v)=>s+v,0):0;
                const bAtt=data.attendanceData[b.player]?data.attendanceData[b.player].reduce((s,v)=>s+v,0):0;
                return (bp+bAtt)-(ap+aAtt);
            }
            if (draftSortConfig.key==='points') {
                let ap=0,bp=0;
                a.picks.forEach(p=>{if(p) ap+=contestantTotals[p]||0;});
                b.picks.forEach(p=>{if(p) bp+=contestantTotals[p]||0;});
                const aAtt=data.attendanceData[a.player]?data.attendanceData[a.player].reduce((s,v)=>s+v,0):0;
                const bAtt=data.attendanceData[b.player]?data.attendanceData[b.player].reduce((s,v)=>s+v,0):0;
                return draftSortConfig.direction==='asc'?(ap+aAtt)-(bp+bAtt):(bp+bAtt)-(ap+aAtt);
            }
            return 0;
        });
        return (
            <div className="content-section">
                <h2 className="section-title">üìã Draft Board üìã</h2>
                <div className="info-banner">Draft picks will be entered after the snake draft following Episode 1.</div>
                <div className="draft-board">
                    <table className="draft-table">
                        <thead><tr>
                            <th className={`sortable ${draftSortConfig.key==='left'?`sorted-${draftSortConfig.direction}`:''}`} onClick={()=>handleDraftSort('left')}>Left</th>
                            <th className={`sortable ${draftSortConfig.key==='player'?`sorted-${draftSortConfig.direction}`:''}`} onClick={()=>handleDraftSort('player')}>Player</th>
                            <th className={`sortable ${draftSortConfig.key==='points'?`sorted-${draftSortConfig.direction}`:''}`} onClick={()=>handleDraftSort('points')}>Total Pts</th>
                            <th>Pick 1</th><th>Pick 2</th><th>Pick 3</th><th>Pick 4</th><th>Pick 5</th><th>Pick 6</th>
                        </tr></thead>
                        <tbody>
                            {sortedDraft.map((entry, idx) => {
                                let cp=0;
                                entry.picks.forEach(p=>{if(p) cp+=contestantTotals[p]||0;});
                                const att=data.attendanceData[entry.player]?data.attendanceData[entry.player].reduce((s,v)=>s+v,0):0;
                                return (
                                    <tr key={idx}>
                                        <td style={{fontWeight:'bold',fontSize:'1.1em'}}>{entry.left}</td>
                                        <td style={{fontWeight:'bold',textAlign:'left',paddingLeft:'15px'}}>{entry.player}</td>
                                        <td style={{fontWeight:'bold',color:'#4ecca3',fontSize:'1.1em'}}>{(cp+att).toFixed(2)}</td>
                                        {entry.picks.map((pick,pi)=>{
                                            if (!pick) return <td key={pi}><span style={{color:'#666',fontSize:'.85em'}}>TBD</span></td>;
                                            const c=data.contestants.find(x=>x.name===pick);
                                            const isElim=c?.eliminated||false;
                                            const tribe=c?.originalTribe||c?.tribe||'';
                                            const tc=getTribeCss(tribe);
                                            return (
                                                <td key={pi} className="contestant-cell">
                                                    <span className={`contestant-tribe ${tc} ${isElim?'eliminated':''}`} style={{padding:'5px 10px',borderRadius:'8px',display:'inline-block',fontSize:'.88em'}}>
                                                        {pick}
                                                    </span>
                                                </td>
                                            );
                                        })}
                                    </tr>
                                );
                            })}
                        </tbody>
                    </table>
                </div>
            </div>
        );
    };

    // ‚îÄ‚îÄ‚îÄ CONTESTANTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const renderContestants = () => {
        const sorted = [...sortedContestants].sort((a,b)=>{
            if (!a.eliminated && b.eliminated) return -1;
            if (a.eliminated && !b.eliminated) return 1;
            const ap=contestantTotals[a.name]||0, bp=contestantTotals[b.name]||0;
            return bp-ap;
        });
        const getTribeGrad = tribe => {
            if (tribe==='Cila') return 'linear-gradient(135deg,#1abc9c,#16a085)';
            if (tribe==='Kalo') return 'linear-gradient(135deg,#9b59b6,#8e44ad)';
            if (tribe==='Vatu') return 'linear-gradient(135deg,#e67e22,#d35400)';
            return '#555';
        };
        return (
            <div className="content-section">
                <h2 className="section-title">üå¥ All Contestants üå¥</h2>
                <div className="tribe-legend">
                    <div className="legend-item">
                        <div className="legend-color" style={{background:'linear-gradient(135deg,#1abc9c,#16a085)'}}></div>
                        <span>Cila (8)</span>
                    </div>
                    <div className="legend-item">
                        <div className="legend-color" style={{background:'linear-gradient(135deg,#9b59b6,#8e44ad)'}}></div>
                        <span>Kalo (8)</span>
                    </div>
                    <div className="legend-item">
                        <div className="legend-color" style={{background:'linear-gradient(135deg,#e67e22,#d35400)'}}></div>
                        <span>Vatu (8)</span>
                    </div>
                </div>
                <div className="contestant-grid">
                    {sorted.map((c,i)=>{
                        const tc=getTribeCss(c.originalTribe||c.tribe);
                        const pts=contestantTotals[c.name]||0;
                        return (
                            <div key={i} className={`contestant-card ${tc} ${c.eliminated?'eliminated':''}`}>
                                <div className="contestant-name">{c.name}</div>
                                <div className="contestant-tribe" style={{background:getTribeGrad(c.originalTribe||c.tribe)}}>
                                    {c.eliminated?'Voted Out':c.tribe}
                                </div>
                                <div className="contestant-points">{pts.toFixed(2)} pts</div>
                                {c.eliminated && <div style={{color:'#e74c3c',fontSize:'.85em',marginTop:'5px'}}>Eliminated Ep {c.eliminatedWeek}</div>}
                            </div>
                        );
                    })}
                </div>
            </div>
        );
    };

    // ‚îÄ‚îÄ‚îÄ WEEKLY SCORES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const renderWeeklyScores = () => {
        const sortedData = getSortedWeeklyData();
        const weekCB = (data.weeklyCheckboxStates&&data.weeklyCheckboxStates[selectedWeek]) || {};
        const weeks = Array.from({length:TOTAL_WEEKS},(_,i)=>i+1);
        return (
            <div className="content-section">
                <h2 className="section-title">üìä Weekly Scores üìä</h2>
                <div className="week-selector">
                    {weeks.map(w=>(
                        <button key={w} className={`week-button ${selectedWeek===w?'active':''}`} onClick={()=>setSelectedWeek(w)}>
                            Ep {w}
                        </button>
                    ))}
                </div>
                <div className="info-banner warning">üìä Episode {selectedWeek} ‚Äî {sortedData.length} contestants active</div>
                <div style={{overflowX:'auto'}}>
                    <table className="scoring-table">
                        <thead><tr>
                            <th className={`sortable ${sortConfig.key==='name'?`sorted-${sortConfig.direction}`:''}`} onClick={()=>handleSort('name')}>Contestant</th>
                            <th>Tribe</th>
                            <th className={`sortable ${sortConfig.key==='weekPoints'?`sorted-${sortConfig.direction}`:''}`} onClick={()=>handleSort('weekPoints')}>Ep {selectedWeek} Pts</th>
                            <th className={`sortable ${sortConfig.key==='totalPoints'?`sorted-${sortConfig.direction}`:''}`} onClick={()=>handleSort('totalPoints')}>Total (thru Ep {selectedWeek})</th>
                            <th>Status</th>
                        </tr></thead>
                        <tbody>
                            {sortedData.map((c,i)=>{
                                const wp=(data.weeklyScores[selectedWeek]&&data.weeklyScores[selectedWeek][c.name])||0;
                                let tot=0; for(let w=1;w<=selectedWeek;w++) tot+=(data.weeklyScores[w]&&data.weeklyScores[w][c.name])||0;
                                const isElim=c.eliminated&&c.eliminatedWeek<=selectedWeek;
                                const tc=getTribeCss(c.tribe);
                                return (
                                    <tr key={i} style={isElim?{opacity:.6}:{}}>
                                        <td style={{fontWeight:'bold',textAlign:'left',paddingLeft:'15px'}}>
                                            {c.name}{isElim&&c.eliminatedWeek===selectedWeek&&<span style={{color:'#e74c3c',marginLeft:'8px',fontSize:'.85em'}}>(Eliminated)</span>}
                                        </td>
                                        <td><span className={`contestant-tribe ${tc}`} style={{padding:'5px 12px',borderRadius:'12px',display:'inline-block',fontSize:'.88em'}}>{isElim?'Voted Out':c.tribe}</span></td>
                                        <td className={`points-value ${wp>=0?'positive-points':'negative-points'}`}>{wp>=0?'+':''}{wp.toFixed(2)}</td>
                                        <td className="positive-points" style={{fontWeight:'bold'}}>{tot.toFixed(2)}</td>
                                        <td>{isElim?<span style={{color:'#e74c3c'}}>‚ùå Out</span>:<span style={{color:'#4ecca3'}}>‚úì Active</span>}</td>
                                    </tr>
                                );
                            })}
                        </tbody>
                    </table>
                </div>
                <div style={{marginTop:'36px'}}>
                    <h3 style={{fontSize:'1.4em',marginBottom:'18px',textAlign:'center',color:'#4ecca3'}}>üìã Scoring Breakdown ‚Äî Episode {selectedWeek}</h3>
                    <div className="info-banner" style={{marginBottom:'14px'}}>Green ‚úì = event occurred for that contestant this episode.</div>
                    <div style={{overflowX:'auto'}}>
                        <table className="grid-scoring-table">
                            <thead><tr>
                                <th className="category-header">Scoring Category</th>
                                {sortedData.map(c=>{
                                    const tc=getTribeCss(c.originalTribe||c.tribe);
                                    const isElimNow=c.eliminated&&c.eliminatedWeek===selectedWeek;
                                    return (
                                        <th key={c.name} className="contestant-header">
                                            <span className={`contestant-tribe ${tc}`} style={{padding:'7px 10px',borderRadius:'8px',display:'inline-block',fontSize:'.95em',writingMode:'horizontal-tb',whiteSpace:'nowrap'}}>
                                                {c.name}{isElimNow&&<div style={{color:'#e74c3c',fontSize:'.7em',marginTop:'3px'}}>üî• OUT</div>}
                                            </span>
                                        </th>
                                    );
                                })}
                            </tr></thead>
                            <tbody>
                                {scoringCategories.map(cat=>(
                                    <tr key={cat.id} style={cat.isNew?{background:'rgba(255,69,0,.06)',borderLeft:'2px solid #FF4500'}:{}}>
                                        <td className="category-header">
                                            {cat.name}{cat.isNew&&<span style={{fontSize:'10px',marginLeft:'4px'}}>üÜï</span>}
                                            <span className={`category-points ${cat.points<0?'negative':''}`}>({cat.points>=0?'+':''}{cat.points})</span>
                                        </td>
                                        {sortedData.map(c=>{
                                            const checked=weekCB[c.name]&&weekCB[c.name][cat.id]||false;
                                            return <td key={c.name}><div className={`checkbox-visual ${checked?'checked':''}`}></div></td>;
                                        })}
                                    </tr>
                                ))}
                                <tr className="total-row">
                                    <td className="category-header"><strong>TOTAL POINTS</strong></td>
                                    {sortedData.map(c=>{
                                        const t=(data.weeklyScores[selectedWeek]&&data.weeklyScores[selectedWeek][c.name])||0;
                                        return <td key={c.name} className="total-points-cell">{t>=0?'+':''}{t.toFixed(2)}</td>;
                                    })}
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        );
    };

    // ‚îÄ‚îÄ‚îÄ ELIMINATIONS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const renderEliminations = () => (
        <div className="content-section">
            <h2 className="section-title">üî• Elimination Timeline üî•</h2>
            {data.eliminationTimeline.length === 0 && (
                <div className="info-banner">No eliminations yet ‚Äî season premieres February 26, 2026!</div>
            )}
            <div className="elimination-timeline">
                {data.eliminationTimeline.map((elim,i)=>(
                    <div key={i} className={`elimination-item ${elim.medical?'medical':''}`}>
                        <div className="elimination-header">
                            <div>
                                <div className="elimination-week">Episode {elim.week}</div>
                                <div className="elimination-name">{elim.contestant}</div>
                            </div>
                            <div className={`elimination-badge ${elim.medical?'medical':'voted'}`}>{elim.medical?'üè• Medical':'üî• Voted Out'}</div>
                        </div>
                        <div className="elimination-reason">{elim.reason}</div>
                    </div>
                ))}
            </div>
            <div className="summary-stats" style={{marginTop:'28px'}}>
                <div className="stat-card"><div className="stat-label">Remaining</div><div className="stat-value">{data.contestants.filter(c=>!c.eliminated).length}</div></div>
                <div className="stat-card"><div className="stat-label">Voted Out</div><div className="stat-value">{data.eliminationTimeline.filter(e=>!e.medical).length}</div></div>
                <div className="stat-card"><div className="stat-label">Medical / Fire</div><div className="stat-value">{data.eliminationTimeline.filter(e=>e.medical).length}</div></div>
                <div className="stat-card"><div className="stat-label">Episodes Aired</div><div className="stat-value">{data.eliminationTimeline.length>0?Math.max(...data.eliminationTimeline.map(e=>e.week)):0}</div></div>
            </div>
        </div>
    );

    // ‚îÄ‚îÄ‚îÄ ATTENDANCE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const renderAttendance = () => {
        const sorted = Object.entries(data.attendanceData)
            .sort((a,b)=>b[1].reduce((s,v)=>s+v,0)-a[1].reduce((s,v)=>s+v,0));
        const weeksAired = Object.values(data.weeklyScores).filter(w=>Object.values(w).some(v=>v!==0)).length || 0;
        const weeks = Array.from({length:TOTAL_WEEKS},(_,i)=>i+1);
        return (
            <div className="content-section">
                <h2 className="section-title">üìÖ Attendance Tracker üìÖ</h2>
                <div className="attendance-grid">
                    {sorted.map(([player,wks])=>{
                        const total=wks.reduce((s,v)=>s+v,0);
                        const attended=wks.filter(v=>v>0).length;
                        return (
                            <div key={player} className="attendance-card">
                                <div className="attendance-name">{player}</div>
                                <div className="attendance-count">{total}</div>
                                <div className="attendance-weeks">{attended} of {weeksAired} episodes</div>
                            </div>
                        );
                    })}
                </div>
                <div style={{marginTop:'36px'}}>
                    <h3 style={{fontSize:'1.4em',marginBottom:'18px',textAlign:'center',color:'#4ecca3'}}>üìã Attendance Breakdown</h3>
                    <div style={{overflowX:'auto'}}>
                        <table className="score-entry-table">
                            <thead><tr>
                                <th style={{textAlign:'left',paddingLeft:'15px'}}>Player</th>
                                {weeks.map(w=><th key={w}>Ep {w}</th>)}
                                <th style={{background:'rgba(78,204,163,.2)'}}>Total</th>
                            </tr></thead>
                            <tbody>
                                {sorted.map(([player,wks])=>{
                                    const total=wks.reduce((s,v)=>s+v,0);
                                    return (
                                        <tr key={player}>
                                            <td style={{fontWeight:'bold',textAlign:'left',paddingLeft:'15px'}}>{player}</td>
                                            {weeks.map((w,i)=>(
                                                <td key={i} style={{fontWeight:'bold',color:wks[i]>0?'#4ecca3':'#555',background:wks[i]>0?'rgba(78,204,163,.1)':'transparent'}}>
                                                    {wks[i]!==undefined?wks[i]:'‚Äî'}
                                                </td>
                                            ))}
                                            <td style={{fontWeight:'bold',color:'#4ecca3',fontSize:'1.1em',background:'rgba(78,204,163,.2)'}}>{total}</td>
                                        </tr>
                                    );
                                })}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        );
    };

    // ‚îÄ‚îÄ‚îÄ WINNER CIRCLES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const renderWinnerCircles = () => {
        const sorted = [...data.winnerCircles].sort((a,b)=>b.season-a.season);
        return (
            <div className="content-section">
                <h2 className="section-title">üèÜ Winner Circles üèÜ</h2>
                <div className="info-banner" style={{marginBottom:'28px'}}>Hall of Champions ‚Äî celebrating our league's greatest competitors across the seasons!</div>
                <div className="winner-circles-grid">
                    {sorted.map((s,i)=>(
                        <div key={i} className="season-card">
                            <div className="season-header">üèùÔ∏è SURVIVOR {s.season} üèùÔ∏è</div>
                            <div className="podium">
                                <div className="podium-position podium-second"><div className="podium-rank">ü•à</div><div className="podium-label">Second Place</div><div className="podium-name">{s.second}</div></div>
                                <div className="podium-position podium-first"><div className="podium-rank">üèÜ</div><div className="podium-label">Champion</div><div className="podium-name">{s.first}</div></div>
                                {s.third&&<div className="podium-position podium-third"><div className="podium-rank">ü•â</div><div className="podium-label">Third Place</div><div className="podium-name">{s.third}</div></div>}
                            </div>
                        </div>
                    ))}
                </div>
                <div className="summary-stats" style={{marginTop:'36px'}}>
                    <div className="stat-card"><div className="stat-label">Total Seasons</div><div className="stat-value">{data.winnerCircles.length}</div></div>
                    <div className="stat-card"><div className="stat-label">Most Championships</div><div className="stat-value">Julie (2)</div></div>
                    <div className="stat-card"><div className="stat-label">Most Podium Finishes</div><div className="stat-value">Julie (4)</div></div>
                    <div className="stat-card"><div className="stat-label">Current Season</div><div className="stat-value">50</div></div>
                </div>
            </div>
        );
    };

    // ‚îÄ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    if (activeView === 'welcome') {
        return (
            <div className="app-container">
                {renderWelcome()}
            </div>
        );
    }

    return (
        <div className="app-container">
            <div className="header">
                <h1>üî• SURVIVOR 50 üî•</h1>
                <div className="subtitle">ALL VETERANS FANTASY LEAGUE</div>
            </div>
            <div className="navigation">
                <button className="nav-button" onClick={()=>setActiveView('welcome')}>üè† Welcome</button>
                <button className={`nav-button ${activeView==='leaderboard'?'active':''}`} onClick={()=>setActiveView('leaderboard')}>üèÜ Leaderboard</button>
                <button className={`nav-button ${activeView==='draft'?'active':''}`} onClick={()=>setActiveView('draft')}>üìã Draft Board</button>
                <button className={`nav-button ${activeView==='contestants'?'active':''}`} onClick={()=>setActiveView('contestants')}>üå¥ Contestants</button>
                <button className={`nav-button ${activeView==='weekly'?'active':''}`} onClick={()=>setActiveView('weekly')}>üìä Weekly Scores</button>
                <button className={`nav-button ${activeView==='eliminations'?'active':''}`} onClick={()=>setActiveView('eliminations')}>üî• Eliminations</button>
                <button className={`nav-button ${activeView==='attendance'?'active':''}`} onClick={()=>setActiveView('attendance')}>üìÖ Attendance</button>
                <button className={`nav-button ${activeView==='winners'?'active':''}`} onClick={()=>setActiveView('winners')}>üëë Winner Circles</button>
            </div>
            {activeView==='leaderboard'   && renderLeaderboard()}
            {activeView==='draft'         && renderDraftBoard()}
            {activeView==='contestants'   && renderContestants()}
            {activeView==='weekly'        && renderWeeklyScores()}
            {activeView==='eliminations'  && renderEliminations()}
            {activeView==='attendance'    && renderAttendance()}
            {activeView==='winners'       && renderWinnerCircles()}
        </div>
    );
};

ReactDOM.render(<SurvivorLeague />, document.getElementById('root'));
</script>
</body>
</html>
